<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction to version control with Git documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css" />

  
    <link rel="shortcut icon" href="_static/coderefinery.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/minipres.js"></script>
        <script src="_static/tabs.js"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="_static/togglebutton.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Introduction to version control with Git
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Core episodes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-motivation">Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-basics">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-branches">Branching and merging</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-conflicts">Conflict resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-remotes">Sharing repositories online</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-archaeology">Inspecting history</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-level">Practical advice: how much Git is necessary?</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-what-to-avoid">What to avoid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Optional episodes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-staging-area">Using the Git staging area</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-recovering">Undoing and recovering</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-interrupted">Interrupted work</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-aliases">Aliases and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-under-the-hood">Git under the hood</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-reference">Quick reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-customizing">Customizing Git</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-resources">Other resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-exercises">List of exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-guide">Instructor guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/core/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Introduction to version control with Git</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction to version control with Git  documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/git-intro/blob/main/content/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="introduction-to-version-control-with-git-why-we-want-to-track-versions-and-how-to-go-back-in-time-to-a-working-version">
<h1>Introduction to version control with Git - Why we want to track versions and how to go back in time to a working version<a class="headerlink" href="#introduction-to-version-control-with-git-why-we-want-to-track-versions-and-how-to-go-back-in-time-to-a-working-version" title="Link to this heading"></a></h1>
<p>This is the introductory lesson to version control using
<a class="reference external" href="https://git-scm.com/">Git</a>. It is assumed to be the very first thing
done in a course.</p>
<p>Our philosophy is that we start from own local repository, branching and
merging (locally), and a brief introduction to pushing to remotes. In
the separate <a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative Git
lesson</a>, we teach more use of
remote repositories and good collaborative workflows. We try to stick to
simple workflows, just enough for researchers who are not obsessed with
Git to be able to work well. We try to avoid commands which might get
you into a confusing state.</p>
<p>The goals of the module as a whole are that the user will feel
comfortable about staging changes, committing them, merging, and
branching.</p>
<div class="admonition-prerequisites prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Prerequisites</p>
<ul class="simple">
<li><p>A reasonably recent version of Git (ideal is 2.28 or newer but we
recommend at least 2.23) is installed <strong>and configured</strong> (<a class="reference external" href="https://coderefinery.github.io/installation/">installation
instructions</a>). But also on older
Git (2.0) the workshop will work and we will offer workarounds for Git below 2.28
or 2.23.</p></li>
<li><p>For one of the episodes we need a <a class="reference external" href="https://github.com">GitHub</a> user
account (but alternatives exist, see below).</p></li>
<li><p>Being comfortable with the command line. No expertise is required, but
the lesson will be mostly taken from the command line. For most commands, where reasonable,
we also offer the possibility to participate through the browser.</p></li>
<li><p>To edit files on the local computer, learners should be familiar with
using a <strong>text editor</strong> on their system. If you are new to text editors,
we recommend to start with Nano or VS Code.</p></li>
</ul>
</div>
<div class="toctree-wrapper compound">
<span id="document-motivation"></span><section id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Make sure nobody leaves the workshop without starting to use some form of version control.</p></li>
<li><p>Discuss the reasons why we advocate distributed version control.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>15 min teaching/demonstration</p></li>
</ul>
</div>
<section id="git-is-all-about-keeping-track-of-changes">
<h3>Git is all about keeping track of changes<a class="headerlink" href="#git-is-all-about-keeping-track-of-changes" title="Link to this heading"></a></h3>
<p>We will learn how to keep track of changes first in a terminal (<a class="reference external" href="https://github.com/bast/runtest/commits/main/runtest/run.py">example
repository</a>):</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/git-log-terminal.png"><img alt="Screenshot of a git log in terminal" src="_images/git-log-terminal.png" style="width: 80%;" /></a>
</figure>
<p>Later also via web interface (<a class="reference external" href="https://github.com/bast/runtest/commits/main/runtest/run.py">example
repository</a>):</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/git-log-github.png"><img alt="Screenshot of a git log on GitHub" class="with-border" src="_images/git-log-github.png" style="width: 80%;" /></a>
</figure>
</section>
<section id="why-do-we-need-to-keep-track-of-versions">
<h3>Why do we need to keep track of versions?<a class="headerlink" href="#why-do-we-need-to-keep-track-of-versions" title="Link to this heading"></a></h3>
<p>Version control is an answer to these questions (do you recognize some of them?):</p>
<ul class="simple">
<li><p>“It broke … hopefully I have a working version somewhere?”</p></li>
<li><p>“Can you please send me the latest version?”</p></li>
<li><p>“Where is the latest version?”</p></li>
<li><p>“Which version are you using?”</p></li>
<li><p>“Which version have the authors used in the paper I am trying to reproduce?”</p></li>
<li><p>“Found a bug! Since when was it there?”</p></li>
<li><p>“I am sure it used to work. When did it change?”</p></li>
<li><p>“My laptop is gone. Is my thesis now gone?”</p></li>
</ul>
</section>
<section id="features-roll-back-branching-merging-collaboration">
<h3>Features: roll-back, branching, merging, collaboration<a class="headerlink" href="#features-roll-back-branching-merging-collaboration" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Roll-back</strong>: you can always go back to a previous version and compare</p></li>
<li><p><strong>Branching and merging</strong>:</p>
<ul>
<li><p>Work on different ideas at the same time</p></li>
<li><p>Different people can work on the same code/project without interfering</p></li>
<li><p>You can experiment with an idea and discard it if it turns out to be a bad idea</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/gophers.png"><img alt="Branching explained with a gopher" src="_images/gophers.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Image created using <a class="reference external" href="https://gopherize.me/">https://gopherize.me/</a>
(<a class="reference external" href="https://twitter.com/jay_gee/status/703360688618536960">inspiration</a>).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Collaboration</strong>: review, compare, share, discuss</p></li>
<li><p><a class="reference external" href="https://github.com/coderefinery/git-intro/network">Example network graph</a></p></li>
</ul>
</section>
<section id="reproducibility">
<h3>Reproducibility<a class="headerlink" href="#reproducibility" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>How do you indicate which version of your code you have used in your paper?</p></li>
<li><p>When you find a bug, how do you know <strong>when precisely</strong> this bug was introduced
(Are published results affected? Do you need to inform collaborators or users of your code?).</p></li>
</ul>
<p>With version control we can “annotate” code (<a class="reference external" href="https://github.com/networkx/networkx/blame/main/networkx/algorithms/boundary.py">browse this example online</a>):</p>
<figure class="align-default" id="id2">
<a class="with-border reference internal image-reference" href="_images/git-annotate.png"><img alt="Example of a git-annotated code with code and history side-by-side" class="with-border" src="_images/git-annotate.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Example of a git-annotated code with code and history side-by-side.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="talking-about-code">
<h3>Talking about code<a class="headerlink" href="#talking-about-code" title="Link to this heading"></a></h3>
<p>Which of these two is more practical?</p>
<ul class="simple">
<li><p>“Clone the code, go to the file ‘src/util.rs’, and search for ‘time_iso8601’”.
Oh! But make sure you use the version from August 2023.”</p></li>
<li><p>Or I can send you a <a class="reference external" href="https://github.com/NordicHPC/sonar/blob/75daafc86582feb06299d6a47c82112f39888152/src/util.rs#L40-L44">permalink</a>:</p></li>
</ul>
<figure class="align-default" id="id3">
<a class="with-border reference internal image-reference" href="_images/code-portion.png"><img alt="Screen-shot of a code portion" class="with-border" src="_images/code-portion.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Permalink that points to a code portion.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="what-we-typically-like-to-snapshot">
<h3>What we typically like to snapshot<a class="headerlink" href="#what-we-typically-like-to-snapshot" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Software (this is how it started but Git/GitHub can track a lot more)</p></li>
<li><p>Scripts</p></li>
<li><p>Documents (plain text files much better suitable than Word documents)</p></li>
<li><p>Manuscripts (Git is great for collaborating/sharing LaTeX or <a class="reference external" href="https://quarto.org/">Quarto</a> manuscripts)</p></li>
<li><p>Configuration files</p></li>
<li><p>Website sources</p></li>
<li><p>Data</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>In this example somebody tried to keep track of versions without a version
control system tool like Git.  Discuss the following directory listing. What
possible problems do you anticipate with this kind of “version control”:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>myproject-2019.zip
myproject-2020-February.zip
myproject-2021-August.zip
myproject-2023-09-19-working.zip
myproject-2023-09-21.zip
myproject-2023-09-21-test.zip
myproject-2023-09-21-myversion.zip
myproject-2023-09-21-newfeature.zip
...
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ul class="simple">
<li><p>Giving a version to a collaborator and merging changes later with own
changes sounds like lots of work.</p></li>
<li><p>What if you discover a bug and want to know since when the bug existed?</p></li>
</ul>
</div>
</div>
</section>
<section id="difficulties-of-version-control">
<h3>Difficulties of version control<a class="headerlink" href="#difficulties-of-version-control" title="Link to this heading"></a></h3>
<p>Despite the benefits, let’s be honest, there are some difficulties:</p>
<ul class="simple">
<li><p>One more thing to learn (it’s probably worth it and will save you more time in the long run; basic career skill).</p></li>
<li><p>Difficult if your collaborators don’t want to use it (in the worst case, you can version control on your side and email them versions).</p></li>
<li><p>Advanced things can be difficult, but basics are often enough (ask others for help when needed).</p></li>
</ul>
<hr class="docutils" />
<div class="admonition-why-git-and-not-another-tool discussion important admonition" id="discussion-1">
<p class="admonition-title">Why Git and not another tool?</p>
<ul class="simple">
<li><p><strong>Easy to set up</strong>: no server needed.</p></li>
<li><p><strong>Very popular</strong>: chances are high you will need to contribute to somebody else’s code which is tracked with Git.</p></li>
<li><p><strong>Distributed</strong>: good backup, no single point of failure, you can track and
clean-up changes offline, simplifies collaboration model for open-source
projects.</p></li>
<li><p>Important <strong>platforms</strong> such as <a class="reference external" href="https://github.com">GitHub</a>, <a class="reference external" href="https://gitlab.com">GitLab</a>, and <a class="reference external" href="https://bitbucket.org">Bitbucket</a>
build on top of Git.</p></li>
</ul>
<p>However, any version control is better than no version control and it is OK to
prefer a different tool than Git such as
<a class="reference external" href="https://subversion.apache.org">Subversion</a>,
<a class="reference external" href="https://www.mercurial-scm.org">Mercurial</a>, <a class="reference external" href="https://pijul.org/">Pijul</a>, or others.</p>
</div>
</section>
</section>
<span id="document-basics"></span><section id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn to create Git repositories and make commits.</p></li>
<li><p>Get a grasp of the structure of a repository.</p></li>
<li><p>Learn how to inspect the project history.</p></li>
<li><p>Learn how to write useful commit log messages.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>35 min teaching/type-along</p></li>
<li><p>40 min exercise</p></li>
</ul>
</div>
<section id="what-is-git-and-what-is-a-git-repository">
<h3>What is Git, and what is a Git repository?<a class="headerlink" href="#what-is-git-and-what-is-a-git-repository" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Git is a version control system: can <strong>record/save snapshots</strong> and track the content of a folder as it changes over time.</p></li>
<li><p>Every time we <strong>commit</strong> a snapshot, Git records a snapshot of the <strong>entire project</strong>, saves it, and assigns it a version.</p></li>
<li><p>These snapshots are kept inside a sub-folder called <code class="docutils literal notranslate"><span class="pre">.git</span></code>.</p></li>
<li><p>If we remove <code class="docutils literal notranslate"><span class="pre">.git</span></code>, we remove the repository and history (but keep the working directory!).</p></li>
<li><p>The directory <code class="docutils literal notranslate"><span class="pre">.git</span></code> uses relative paths - you can move the whole repository somewhere else and it will still work.</p></li>
<li><p>Git doesn’t do anything unless you ask it to (it <strong>does not record anything automatically</strong>).</p></li>
<li><p>Multiple interfaces to Git exist (command line, graphical interfaces, web interfaces).</p></li>
</ul>
</section>
<section id="recording-a-snapshot-with-git">
<h3>Recording a snapshot with Git<a class="headerlink" href="#recording-a-snapshot-with-git" title="Link to this heading"></a></h3>
<ul>
<li><p>Git takes snapshots only if we request it.</p></li>
<li><p>We will record changes in two steps (we will later explain why this is a recommended practice).</p></li>
<li><p>Example (we don’t need to type yet):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>FILE.txt
<span class="gp">$ </span>git<span class="w"> </span>commit

<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>FILE.txt<span class="w"> </span>ANOTHERFILE.txt
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
</li>
<li><p>We first focus (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>, we “stage” the change), then record (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>):</p></li>
</ul>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/git_stage_commit.svg"><img alt="Git staging" src="_images/git_stage_commit.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-text">Git staging and committing.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-question-for-the-more-advanced-participants discussion important admonition" id="discussion-0">
<p class="admonition-title">Question for the more advanced participants</p>
<p>What do you think will be the outcome if you
stage a file and then edit it and stage it again, do this several times and
at the end perform a commit? Think of focusing several scenes and pressing the
shutter at the end.</p>
</div>
</section>
<section id="configuring-git-command-line">
<h3>Configuring Git command line<a class="headerlink" href="#configuring-git-command-line" title="Link to this heading"></a></h3>
<p>Before we start using Git on the command line, we need to configure Git.
This is also part of the
<a class="reference external" href="https://coderefinery.github.io/installation/shell-and-git/#configuration">installation instructions</a>
but we need to make sure we all have
set name, email address, editor, and
default branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">&quot;Your Name&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.email<span class="w"> </span>yourname@example.com
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>core.editor<span class="w"> </span>nano
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>init.defaultBranch<span class="w"> </span>main
</pre></div>
</div>
<p>Verify with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--list
</pre></div>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<p>Instructors, give learners enough time to do the above configuration steps.</p>
</div>
</section>
<section id="type-along-tracking-a-guacamole-recipe-with-git">
<h3>Type-along: Tracking a guacamole recipe with Git<a class="headerlink" href="#type-along-tracking-a-guacamole-recipe-with-git" title="Link to this heading"></a></h3>
<p>We will learn how to initialize a Git repository, how to track changes, and how
to make delicious guacamole! (Inspiration for this example based on a
suggestion by B. Smith in a discussion in the Carpentries mailing list)</p>
<p>The motivation for taking a cooking recipe instead of a program is that everybody can relate to cooking
but not everybody may be able to relate to a program written in e.g. Python or another specific language.</p>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-2">
<p class="admonition-title">Instructor note</p>
<p>Instructors, please encourage now that participants type along.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is possible to go through this lesson in the command line or in the browser
(on GitHub).</p>
<ul class="simple">
<li><p>We recommend to start with the command line but later to also try in the browser.</p></li>
<li><p>If you get really stuck in the command line, try following in the browser and
later you can try to return to the command line.</p></li>
</ul>
</div>
</section>
<section id="creating-a-repository">
<h3>Creating a repository<a class="headerlink" href="#creating-a-repository" title="Link to this heading"></a></h3>
<p>One of the basic principles of Git is that it is <strong>easy to create repositories</strong>:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-0-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>recipe
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>recipe
<span class="gp">$ </span>git<span class="w"> </span>init<span class="w"> </span>-b<span class="w"> </span>main
</pre></div>
</div>
<p>That’s it! With <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span> <span class="pre">-b</span> <span class="pre">main</span></code> have now created an empty Git repository
where <code class="docutils literal notranslate"><span class="pre">main</span></code> is the default branch (more about branches later).</p>
<p>We will use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> a lot to check out what is going on:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status

<span class="go">On branch main</span>

<span class="go">No commits yet</span>

<span class="go">nothing to commit (create/copy files and use &quot;git add&quot; to track)</span>
</pre></div>
</div>
<p>We will make sense of this information during this workshop.</p>
</div><div aria-labelledby="tab-0-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>First log into GitHub, then follow the screenshots and descriptions below.</p>
<figure class="align-default" id="id3">
<a class="with-border reference internal image-reference" href="_images/new-repo-plus.png"><img alt="Screenshot on GitHub before a new repository form is opened" class="with-border" src="_images/new-repo-plus.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the “plus” symbol on top right, then on “New repository”.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Another way to create a new repository is to visit
<a class="reference external" href="https://github.com/new">https://github.com/new</a> directly.</p>
<figure class="align-default" id="id4">
<a class="with-border reference internal image-reference" href="_images/new-repo-form.png"><img alt="Screenshot on GitHub just before creating a new repository" class="with-border" src="_images/new-repo-form.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Choose a repository name, add a short description, <strong>check “Add a
README file”</strong>, finally “Create repository”.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>After you have clicked “Create repository” you should see a repository overview
with one file (README.md) and one commit.</p>
</div></div>
</section>
<section id="adding-files-and-committing-changes">
<h3>Adding files and committing changes<a class="headerlink" href="#adding-files-and-committing-changes" title="Link to this heading"></a></h3>
<p>Let us now <strong>create two files</strong>.</p>
<p>One file is called <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code> and contains:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>*<span class="w"> </span><span class="m">2</span><span class="w"> </span>avocados
*<span class="w"> </span><span class="m">1</span><span class="w"> </span>chili
*<span class="w"> </span><span class="m">1</span><span class="w"> </span>lime
*<span class="w"> </span><span class="m">2</span><span class="w"> </span>tsp<span class="w"> </span>salt
</pre></div>
</div>
<p>The second file is called <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code> and contains:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>*<span class="w"> </span>chop<span class="w"> </span>avocados
*<span class="w"> </span>chop<span class="w"> </span>onion
*<span class="w"> </span>chop<span class="w"> </span>chili
*<span class="w"> </span>squeeze<span class="w"> </span>lime
*<span class="w"> </span>add<span class="w"> </span>salt
*<span class="w"> </span>and<span class="w"> </span>mix<span class="w"> </span>well
</pre></div>
</div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-1-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-1-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>As mentioned above, in Git you can always check the status of files in your repository using
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>. It is always a safe command to run and in general a good idea to
do when you are trying to figure out what to do next:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status

<span class="go">On branch main</span>

<span class="go">No commits yet</span>

<span class="go">Untracked files:</span>
<span class="go">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span>
<span class="go">    ingredients.txt</span>
<span class="go">    instructions.txt</span>

<span class="go">nothing added to commit but untracked files present (use &quot;git add&quot; to track)</span>
</pre></div>
</div>
<p>The two files are untracked in the repository (directory). You want to <strong>add the files</strong> (focus the camera)
to the list of files tracked by Git. Git does not track
any files automatically and you need make a conscious decision to add a file. Let’s do what
Git hints at, and add the files, one by one:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>ingredients.txt
<span class="gp">$ </span>git<span class="w"> </span>status

<span class="go">On branch main</span>

<span class="go">No commits yet</span>

<span class="go">Changes to be committed:</span>
<span class="go">  (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)</span>
<span class="go">    new file:   ingredients.txt</span>

<span class="go">Untracked files:</span>
<span class="go">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span>
<span class="go">    instructions.txt</span>
</pre></div>
</div>
<p>Now this change is <em>staged</em> and ready to be committed.
Let us now commit the change to the repository:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;adding ingredients&quot;</span>

<span class="go">[main (root-commit) f146d25] adding ingredients</span>
<span class="go"> 1 file changed, 4 insertions(+)</span>
<span class="go"> create mode 100644 ingredients.txt</span>
</pre></div>
</div>
<p>Right after we query the status to get this useful command into our muscle memory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status
</pre></div>
</div>
<p>Now stage and commit also the other file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>instructions.txt
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;adding instructions&quot;</span>
</pre></div>
</div>
<p>We will add a third file to the repository, <code class="docutils literal notranslate"><span class="pre">README.md</span></code>, containing:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># recipe</span>

This is an exercise repository.
</pre></div>
</div>
<p>Now stage and commit also the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>README.md
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;adding README&quot;</span>
</pre></div>
</div>
<p>What does the <code class="docutils literal notranslate"><span class="pre">-m</span></code> flag mean? Let us check the help page for that command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span><span class="nb">help</span><span class="w"> </span>commit
</pre></div>
</div>
<p>You should see a very long help page as the tool is very versatile (press q to quit).
Do not worry about this now but keep in mind that you can always read the help files
when in doubt. Searching online can also be useful, but choosing search terms
to find relevant information takes some practice and discussions in some
online threads may be confusing.
Note that help pages also work when you don’t have a network connection!</p>
</div><div aria-labelledby="tab-1-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><figure class="align-default" id="id5">
<a class="with-border reference internal image-reference" href="_images/add-file.png"><img alt="Screenshot on GitHub before a new file is created" class="with-border" src="_images/add-file.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Click on “Add file”, then “Create new file”.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<a class="with-border reference internal image-reference" href="_images/edit-file.png"><img alt="Screenshot on GitHub when editing a file" class="with-border" src="_images/edit-file.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Edit the file and specify the file name.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id7">
<a class="with-border reference internal image-reference" href="_images/commit-changes.png"><img alt="Screenshot on GitHub when editing the commit message" class="with-border" src="_images/commit-changes.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Before you commit the change, adjust the commit message.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>After you have added <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code>, add also <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code> in a similar
way.</p>
<p>We have added two files, each in one commit. However, we ended up with
three files and three commits since <code class="docutils literal notranslate"><span class="pre">README.md</span></code> was automatically committed
when we created the repository on GitHub.</p>
</div></div>
</section>
<section id="exercise-record-changes">
<span id="id1"></span><h3>Exercise: Record changes<a class="headerlink" href="#exercise-record-changes" title="Link to this heading"></a></h3>
<div class="admonition-basic-1-record-changes exercise important admonition" id="exercise-0">
<p class="admonition-title">Basic-1: Record changes</p>
<p>Add 1/2 onion to <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code> and also the instruction
to “enjoy!” to <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-2-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-2-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>After modifying the files, do not stage the changes yet (do not <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>
yet).</p>
<p>When you are done editing the files, try <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff
</pre></div>
</div>
<p>You will see (can you identify in there the two added lines?):</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/ingredients.txt b/ingredients.txt</span>
<span class="gh">index 4422a31..ba8854f 100644</span>
<span class="gd">--- a/ingredients.txt</span>
<span class="gi">+++ b/ingredients.txt</span>
<span class="gu">@@ -2,3 +2,4 @@</span>
<span class="w"> </span>* 1 chili
<span class="w"> </span>* 1 lime
<span class="w"> </span>* 2 tsp salt
<span class="gi">+* 1/2 onion</span>
<span class="gh">diff --git a/instructions.txt b/instructions.txt</span>
<span class="gh">index 7811273..2b11074 100644</span>
<span class="gd">--- a/instructions.txt</span>
<span class="gi">+++ b/instructions.txt</span>
<span class="gu">@@ -4,3 +4,4 @@</span>
<span class="w"> </span>* squeeze lime
<span class="w"> </span>* add salt
<span class="w"> </span>* and mix well
<span class="gi">+* enjoy!</span>
</pre></div>
</div>
<p>Now first stage and commit each change separately (what happens when we leave out the <code class="docutils literal notranslate"><span class="pre">-m</span></code> flag?):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>ingredients.txt
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;add half an onion&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>instructions.txt
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w">                   </span><span class="c1"># &lt;-- we have left out -m &quot;...&quot;</span>
</pre></div>
</div>
<p>When you leave out the <code class="docutils literal notranslate"><span class="pre">-m</span></code> flag, Git should open an editor where you can edit
your commit message. This message will be associated and stored with the
changes you made. This message is your chance to explain what you’ve done and
convince others (and your future self) that the changes you made were
justified.  Write a message and save and close the file.</p>
<p>When you are done committing the changes, experiment with these commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log
<span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--stat
<span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
</pre></div>
</div>
</div><div aria-labelledby="tab-2-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>We can make modifications to a file by clicking on the file and then the
pen symbol:</p>
<figure class="align-default" id="id8">
<a class="with-border reference internal image-reference" href="_images/pen-symbol.png"><img alt="Screenshot on GitHub before clicking on the pen symbol" class="with-border" src="_images/pen-symbol.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">By clicking on the pen symbol we can switch to edit mode.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id9">
<a class="with-border reference internal image-reference" href="_images/preview.png"><img alt="Screenshot on GitHub when previewing file changes" class="with-border" src="_images/preview.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Before committing the change, click on “Preview”.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Our goal is to arrive at two new commits:</p>
<ul class="simple">
<li><p>“add half an onion” (modifying <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code>)</p></li>
<li><p>“don’t forget to enjoy” (modifying <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code>)</p></li>
</ul>
<p>When you are done committing the changes, try to browse commit history
on GitHub.</p>
</div></div>
</div>
</section>
<section id="git-history-and-log">
<h3>Git history and log<a class="headerlink" href="#git-history-and-log" title="Link to this heading"></a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-3-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-3-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>If you haven’t yet, please try now <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log

<span class="go">commit e7cf023efe382340e5284c278c6ae2c087dd3ff7 (HEAD -&gt; main)</span>
<span class="go">Author: Radovan Bast &lt;bast@users.noreply.github.com&gt;</span>
<span class="go">Date:   Sun Sep 17 19:12:47 2023 +0200</span>

<span class="go">    don&#39;t forget to enjoy</span>

<span class="go">commit 79161b6e67c62ad4688a58c1e54183334611a390</span>
<span class="go">Author: Radovan Bast &lt;bast@users.noreply.github.com&gt;</span>
<span class="go">Date:   Sun Sep 17 19:12:32 2023 +0200</span>

<span class="go">    add half an onion</span>

<span class="go">commit a3394e39535343c4dae3bb4f703741a31aa8b78a</span>
<span class="go">Author: Radovan Bast &lt;bast@users.noreply.github.com&gt;</span>
<span class="go">Date:   Sun Sep 17 18:47:14 2023 +0200</span>

<span class="go">    adding README</span>

<span class="go">commit 369624674e63de48055a65bf63055bd59c985d22</span>
<span class="go">Author: Radovan Bast &lt;bast@users.noreply.github.com&gt;</span>
<span class="go">Date:   Sun Sep 17 18:46:58 2023 +0200</span>

<span class="go">    adding instructions</span>

<span class="go">commit f146d25b94569a15e94d7f0da6f15d7554f76c49</span>
<span class="go">Author: Radovan Bast &lt;bast@users.noreply.github.com&gt;</span>
<span class="go">Date:   Sun Sep 17 18:35:52 2023 +0200</span>

<span class="go">    adding ingredients</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><figure class="align-default" id="id10">
<a class="with-border reference internal image-reference" href="_images/commits.png"><img alt="Screenshot on GitHub before clicking on commit history" class="with-border" src="_images/commits.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the history symbol with (here) 5 commits.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id11">
<a class="with-border reference internal image-reference" href="_images/history.png"><img alt="Screenshot of GitHub repository commit history" class="with-border" src="_images/history.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">In this overview you can browse each commit individually.</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>On GitHub you can also compare arbitrary two commits (replace “USER”,
“HASH1”, and “HASH2”):
<code class="docutils literal notranslate"><span class="pre">https://github.com/USER/recipe/compare/HASH1..HASH2</span></code></p>
<p>Try it with two of your commits.</p>
</div></div>
<ul class="simple">
<li><p>We can browse the development and access each state that we have committed.</p></li>
<li><p>The long hashes uniquely label a state of the code.</p></li>
<li><p>They are not just integers counting 1, 2, 3, 4, … (why?).</p></li>
<li><p>Output is in reverse chronological order, i.e. <strong>newest commits on top</strong>.</p></li>
<li><p>We will use them when comparing versions and when going back in time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--oneline</span></code> only shows the first 7 characters of the commit hash and is good to get an overview.</p></li>
<li><p>If the first characters of the hash are unique it is not necessary to type the entire hash.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--stat</span></code> is nice to show which files have been modified.</p></li>
</ul>
</section>
<section id="optional-exercises-comparing-changes">
<span id="exercise-diff-and-rename"></span><h3>Optional exercises: Comparing changes<a class="headerlink" href="#optional-exercises-comparing-changes" title="Link to this heading"></a></h3>
<div class="admonition-optional-basic-2-comparing-and-showing-commits exercise important admonition" id="exercise-1">
<p class="admonition-title">(optional) Basic-2: Comparing and showing commits</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-4-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-4-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-4-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Have a look at specific commits with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span> <span class="pre">HASH</span></code>.</p></li>
<li><p>Inspect differences between commit hashes with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">HASH1</span> <span class="pre">HASH2</span></code>.</p></li>
</ol>
</div><div aria-labelledby="tab-4-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><ol class="arabic simple">
<li><p>Have a look at specific commits.</p></li>
<li><p>Inspect differences between commits.</p></li>
</ol>
<p>Use the screenshots under “Git history and log”.</p>
</div></div>
</div>
<div class="admonition-optional-basic-3-visual-diff-tools exercise important admonition" id="exercise-2">
<p class="admonition-title">(optional) Basic-3: Visual diff tools</p>
<p>This exercise is only relevant for the command line. In the browser,
the preview is already side-by-side and “visual”.</p>
<ul class="simple">
<li><p>Make further modifications and experiment with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">difftool</span></code> (requires installing one of the <a class="reference external" href="https://coderefinery.github.io/installation/difftools/">visual diff tools</a>):</p></li>
</ul>
<p>On Windows or Linux:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>difftool<span class="w"> </span>--tool<span class="o">=</span>meld<span class="w"> </span>HASH
</pre></div>
</div>
<p>On macOS:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>difftool<span class="w"> </span>--tool<span class="o">=</span>opendiff<span class="w"> </span>HASH
</pre></div>
</div>
<figure class="align-default" id="id12">
<a class="reference internal image-reference" href="_images/meld.png"><img alt="Git difftool using meld" src="_images/meld.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Git difftool using meld.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>You probably want to use the same visual diff tool every time and
you can configure Git for that:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>diff.tool<span class="w"> </span>meld
</pre></div>
</div>
</div>
<div class="admonition-optional-basic-4-browser-and-command-line exercise important admonition" id="exercise-3">
<p class="admonition-title">(optional) Basic-4: Browser and command line</p>
<p>You have noticed that it is possible to work either in the command
line or in the browser. It could help to deepen the understanding
trying to do the above steps in both.</p>
<ul class="simple">
<li><p>If you have managed to do the above in the command line, try now in the browser.</p></li>
<li><p>If you got stuck in the command line and move to the browser, try now to trouble-shoot the command line Git.</p></li>
</ul>
</div>
</section>
<section id="writing-useful-commit-messages">
<h3>Writing useful commit messages<a class="headerlink" href="#writing-useful-commit-messages" title="Link to this heading"></a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--oneline</span></code> or browsing a repository on the web, we better
understand that the first line of the commit message is very important.</p>
<p>Good example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>increase threshold alpha to 2.0

the motivation for this change is
to enable ...
...
this is based on a discussion in #123
</pre></div>
</div>
<p>Convention: <strong>one line summarizing the commit, then one empty line,
then paragraph(s) with more details in free form, if necessary</strong>.</p>
<ul class="simple">
<li><p><strong>Why something was changed is more important than what has changed.</strong></p></li>
<li><p>Cross-reference to issues and discussions if possible/relevant.</p></li>
<li><p>Bad commit messages: “fix”, “oops”, “save work”</p></li>
<li><p>Bad examples: <a class="reference external" href="http://whatthecommit.com">http://whatthecommit.com</a></p></li>
<li><p>Write commit messages in English that will be understood
15 years from now by someone else than you. Or by your future you.</p></li>
<li><p>Many projects start out as projects “just for me” and end up to be successful projects
that are developed by 50 people over decades.</p></li>
<li><p><a class="reference external" href="https://help.github.com/articles/creating-a-commit-with-multiple-authors/">Commits with multiple authors</a> are possible.</p></li>
</ul>
<p>Good references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://fatbusinessman.com/2019/my-favourite-git-commit">“My favourite Git commit”</a></p></li>
<li><p><a class="reference external" href="https://who-t.blogspot.com/2009/12/on-commit-messages.html">“On commit messages”</a></p></li>
<li><p><a class="reference external" href="https://chris.beams.io/posts/git-commit/">“How to Write a Git Commit Message”</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A great way to learn how to write commit messages and to get inspired by their
style choices: <strong>browse repositories of codes that you use/like</strong>:</p>
<p>Some examples (but there are so many good examples):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/scipy/scipy/commits/main">SciPy</a></p></li>
<li><p><a class="reference external" href="https://github.com/numpy/numpy/commits/main">NumPy</a></p></li>
<li><p><a class="reference external" href="https://github.com/pandas-dev/pandas/commits/main">Pandas</a></p></li>
<li><p><a class="reference external" href="https://github.com/JuliaLang/julia/commits/master">Julia</a></p></li>
<li><p><a class="reference external" href="https://github.com/tidyverse/ggplot2/commits/main">ggplot2</a>,
compare with their <a class="reference external" href="https://github.com/tidyverse/ggplot2/releases">release
notes</a></p></li>
<li><p><a class="reference external" href="https://github.com/pallets/flask/commits/main">Flask</a>,
compare with their <a class="reference external" href="https://github.com/pallets/flask/blob/main/CHANGES.rst">release
notes</a></p></li>
</ul>
<p>When designing commit message styles consider also these:</p>
<ul class="simple">
<li><p>How will you easily generate a changelog or release notes?</p></li>
<li><p>During code review, you can help each other improving commit messages.</p></li>
</ul>
</div>
<p>But remember: it is better to make any commit, than no commit. Especially in small projects.
<strong>Let not the perfect be the enemy of the good enough</strong>.</p>
</section>
<section id="ignoring-files-and-paths-with-gitignore">
<span id="gitignore"></span><h3>Ignoring files and paths with .gitignore<a class="headerlink" href="#ignoring-files-and-paths-with-gitignore" title="Link to this heading"></a></h3>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>Should we add and track all files in a project?</p></li>
<li><p>How about generated files?</p></li>
<li><p>Why is it considered a bad idea to commit compiled binaries to version control?</p></li>
<li><p>What types of generated files do you know?</p></li>
</ul>
</div>
<p>Compiled and generated files are not
committed to version control. There are many reasons for this:</p>
<ul class="simple">
<li><p>These files can make it more difficult to run on different platforms.</p></li>
<li><p>These files are automatically generated and thus do not contribute in any meaningful way.</p></li>
<li><p>When tracking generated files you could see differences in the code although you haven’t touched the code.</p></li>
</ul>
<p>For this we use <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> files. Example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># ignore compiled python 2 files</span>
*.pyc
<span class="c1"># ignore compiled python 3 files</span>
__pycache__
</pre></div>
</div>
<p>An example taken from the <a class="reference external" href="https://git-scm.com/docs/gitignore">official Git documentation</a>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># ignore objects and archives, anywhere in the tree.</span>
*.<span class="o">[</span>oa<span class="o">]</span>
<span class="c1"># ignore generated html files,</span>
*.html
<span class="c1"># except foo.html which is maintained by hand</span>
!foo.html
<span class="c1"># ignore everything under build directory</span>
build/
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> should be part of the repository because we want to make sure that all developers see the same behavior.</p></li>
<li><p><strong>All files should be either tracked or ignored</strong>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> uses something called a
<a class="reference external" href="https://en.wikipedia.org/wiki/Glob_(programming)">shell glob syntax</a> for
determining file patterns to ignore. You can read more about the syntax in the
<a class="reference external" href="https://git-scm.com/docs/gitignore">documentation</a>.</p></li>
<li><p>You can have <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> files in lower level directories and they affect the paths below.</p></li>
</ul>
</section>
<section id="graphical-user-interfaces">
<h3>Graphical user interfaces<a class="headerlink" href="#graphical-user-interfaces" title="Link to this heading"></a></h3>
<p>We have seen how to make commits in the command line and via the GitHub website.
But it is also possible to work from within a Git graphical user interface (GUI):</p>
<ul class="simple">
<li><p><a class="reference external" href="https://desktop.github.com">GitHub Desktop</a></p></li>
<li><p><a class="reference external" href="https://www.sourcetreeapp.com">SourceTree</a></p></li>
<li><p><a class="reference external" href="https://git-scm.com/downloads/guis">List of third-party GUIs</a></p></li>
</ul>
</section>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h3>
<p>Now we know how to save snapshots:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>FILE<span class="o">(</span>S<span class="o">)</span>
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
<p>And this is what we do as we program.</p>
<p>Every state is then saved and later we will learn how to go back to these “checkpoints”
and how to undo things.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>init<span class="w"> </span>-b<span class="w"> </span>main<span class="w">  </span><span class="c1"># initialize new repository (main is default branch)</span>
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w">           </span><span class="c1"># add files or stage file(s)</span>
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w">        </span><span class="c1"># commit staged file(s)</span>
<span class="gp">$ </span>git<span class="w"> </span>status<span class="w">        </span><span class="c1"># see what is going on</span>
<span class="gp">$ </span>git<span class="w"> </span>log<span class="w">           </span><span class="c1"># see history</span>
<span class="gp">$ </span>git<span class="w"> </span>diff<span class="w">          </span><span class="c1"># show unstaged/uncommitted modifications</span>
<span class="gp">$ </span>git<span class="w"> </span>show<span class="w">          </span><span class="c1"># show the change for a specific commit</span>
<span class="gp">$ </span>git<span class="w"> </span>mv<span class="w">            </span><span class="c1"># move/rename tracked files</span>
<span class="gp">$ </span>git<span class="w"> </span>rm<span class="w">            </span><span class="c1"># remove tracked files</span>
</pre></div>
</div>
<p>Git is not ideal for large binary files
(for this consider <a class="reference external" href="http://git-annex.branchable.com">git-annex</a>).</p>
<div class="admonition-basic-5-test-your-understanding exercise important admonition" id="exercise-4">
<p class="admonition-title">Basic-5: Test your understanding</p>
<p>Which command(s) below would save the changes of <code class="docutils literal notranslate"><span class="pre">myfile.txt</span></code>
to an existing local Git repository?</p>
<ol class="arabic">
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;my recent changes&quot;</span>
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>init<span class="w"> </span>myfile.txt
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;my recent changes&quot;</span>
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>myfile.txt
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;my recent changes&quot;</span>
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span>myfile.txt<span class="w"> </span><span class="s2">&quot;my recent changes&quot;</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>Would only create a commit if files have already been staged.</p></li>
<li><p>Would try to create a new repository in a folder “myfile.txt”.</p></li>
<li><p><strong>Is correct: first add the file to the staging area, then commit.</strong></p></li>
<li><p>Would try to commit a file “my recent changes” with the message myfile.txt.</p></li>
</ol>
</div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>It takes only one command to initialize a Git repository: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span> <span class="pre">-b</span> <span class="pre">main</span></code>.</p></li>
<li><p>Commits should be used to tell a story.</p></li>
<li><p>Git uses the .git folder to store the snapshots.</p></li>
<li><p>Don’t be afraid to stage and commit often. Better too often than not often enough.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-branches"></span><section id="branching-and-merging">
<h2>Branching and merging<a class="headerlink" href="#branching-and-merging" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Be able to create and merge branches.</p></li>
<li><p>Know the difference between a branch and a tag.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>30 min teaching/type-along</p></li>
<li><p>20 min exercise</p></li>
</ul>
</div>
<section id="motivation-for-branches">
<h3>Motivation for branches<a class="headerlink" href="#motivation-for-branches" title="Link to this heading"></a></h3>
<p>In the previous section we tracked a guacamole recipe with Git.</p>
<p>Up until now our repository had only one branch with one commit coming
after the other:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/git-branch-1.svg"><img alt="Linear Git repository" src="_images/git-branch-1.svg" width="40%" /></a>
<figcaption>
<p><span class="caption-text">Linear Git repository.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>Commits are depicted here as little boxes with abbreviated hashes.</p></li>
<li><p>Here the branch <code class="docutils literal notranslate"><span class="pre">main</span></code> points to a commit.</p></li>
<li><p>“HEAD” is the current position (remember the recording head of tape
recorders?). When we say <code class="docutils literal notranslate"><span class="pre">HEAD</span></code>, we mean those literal letters -
this isn’t a placeholder for something else.</p></li>
<li><p>When we talk about branches, we often mean all parent commits, not only the commit pointed to.</p></li>
</ul>
<p><strong>Now we want to do this:</strong></p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/gophers.png"><img alt="Branching explained with a gopher" src="_images/gophers.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Image created using <a class="reference external" href="https://gopherize.me/">https://gopherize.me/</a>
(<a class="reference external" href="https://twitter.com/jay_gee/status/703360688618536960">inspiration</a>).</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Software development is often not linear:</p>
<ul class="simple">
<li><p>We typically need at least one version of the code to “work” (to compile, to give expected results, …).</p></li>
<li><p>At the same time we work on new features, often several features concurrently.
Often they are unfinished.</p></li>
<li><p>We need to be able to separate different lines of work really well.</p></li>
</ul>
<p>The strength of version control is that it permits the researcher to <strong>isolate
different tracks of work</strong>, which can later be merged to create a composite
version that contains all changes:</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/git-collaborative.svg"><img alt="Isolated tracks of work" src="_images/git-collaborative.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-text">Isolated tracks of work.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p>We see branching points and merging points.</p></li>
<li><p>Main line development is often called <code class="docutils literal notranslate"><span class="pre">main</span></code> or <code class="docutils literal notranslate"><span class="pre">master</span></code>.</p></li>
<li><p>Other than this convention there is nothing special about <code class="docutils literal notranslate"><span class="pre">main</span></code> or <code class="docutils literal notranslate"><span class="pre">master</span></code>, it is a branch like any other.</p></li>
<li><p>Commits form a directed acyclic graph (we have left out the arrows to avoid confusion about the time arrow).</p></li>
</ul>
<p>A group of commits that create a single narrative are called a <strong>branch</strong>.
There are different branching strategies, but it is useful to think that a branch
tells the story of a feature, e.g. “fast sequence extraction” or “Python interface” or “fixing bug in
matrix inversion algorithm”.</p>
<div class="important admonition">
<p class="admonition-title"><strong>An important alias</strong></p>
<p>We will now define an <em>alias</em> in Git, to be able to nicely visualize branch
structure in the terminal without having to remember a long Git command
(more details about aliases are given
in a later section).  <strong>This is extensively used in the rest of this
and other lessons</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.graph<span class="w"> </span><span class="s2">&quot;log --all --graph --decorate --oneline&quot;</span>
</pre></div>
</div>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<p>Instructors, please demonstrate how to set this alias and ensure that
all create it. This is very important for this lesson and
git-collaborative.</p>
</div>
<p>Let us inspect the project history using the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> alias:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph

<span class="go">* e7cf023 (HEAD -&gt; main) don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We have a couple commits and only
one development line (branch) and this branch is called <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Commits are states characterized by a 40-character hash (checksum).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> print abbreviations of these checksums.</p></li>
<li><p><strong>Branches are pointers that point to a commit.</strong></p></li>
<li><p>Branch <code class="docutils literal notranslate"><span class="pre">main</span></code> points to a commit (in this example it is <code class="docutils literal notranslate"><span class="pre">e7cf023efe382340e5284c278c6ae2c087dd3ff7</span></code> but on your computer
the hash will be different).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">HEAD</span></code> is another pointer, it points to where we are right now (currently <code class="docutils literal notranslate"><span class="pre">main</span></code>)</p></li>
</ul>
<p>In the following we will learn how to create branches,
how to switch between them, how to merge branches,
and how to remove them afterwards.</p>
</section>
<section id="creating-and-working-with-branches">
<h3>Creating and working with branches<a class="headerlink" href="#creating-and-working-with-branches" title="Link to this heading"></a></h3>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-2">
<p class="admonition-title">Instructor note</p>
<p>We do the following part together. Encourage participants to type along.</p>
</div>
<div class="admonition-it-is-possible-to-create-and-merge-branches-directly-on-github admonition">
<p class="admonition-title">It is possible to create and merge branches directly on GitHub</p>
<ul class="simple">
<li><p>However, we do not have screenshots for that in this episode</p></li>
<li><p>But if you prefer to work in the browser, please try it</p></li>
<li><p>Please contribute screenshots to this lesson</p></li>
</ul>
</div>
<p>Let’s create a branch called <code class="docutils literal notranslate"><span class="pre">experiment</span></code> where we add cilantro to <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code>
(text after “#” are comments and not part of the command).</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>experiment<span class="w"> </span>main<span class="w">  </span><span class="c1"># creates branch &quot;experiment&quot; from &quot;main&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>experiment<span class="w">       </span><span class="c1"># switch to branch &quot;experiment&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w">                  </span><span class="c1"># list all local branches and show on which branch we are</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span></code> does not work, your Git version might be older than from 2019.
On older Git it is <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span></code>.</p>
</div>
<ul>
<li><p>Verify that you are on the <code class="docutils literal notranslate"><span class="pre">experiment</span></code> branch (note that <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> also
makes it clear what branch you are on: <code class="docutils literal notranslate"><span class="pre">HEAD</span> <span class="pre">-&gt;</span> <span class="pre">branchname</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch

<span class="go">* experiment</span>
<span class="go">  main</span>
</pre></div>
</div>
<p>This command shows where we are, it does not create a branch.</p>
</li>
<li><p>Then add 2 tbsp cilantro <strong>on top</strong> of the <code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="hll">*<span class="w"> </span><span class="m">2</span><span class="w"> </span>tbsp<span class="w"> </span>cilantro
</span>*<span class="w"> </span><span class="m">2</span><span class="w"> </span>avocados
*<span class="w"> </span><span class="m">1</span><span class="w"> </span>chili
*<span class="w"> </span><span class="m">1</span><span class="w"> </span>lime
*<span class="w"> </span><span class="m">2</span><span class="w"> </span>tsp<span class="w"> </span>salt
*<span class="w"> </span><span class="m">1</span>/2<span class="w"> </span>onion
</pre></div>
</div>
</li>
<li><p>Stage this and commit it with the message “let us try with some cilantro”.</p></li>
<li><p>Then reduce the amount of cilantro to 1 tbsp, stage and commit again with “maybe little bit less cilantro”.</p></li>
</ul>
<p>We have created <strong>two new commits</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph

<span class="hll"><span class="go">* bcb8b78 (HEAD -&gt; experiment) maybe little bit less cilantro</span>
</span><span class="hll"><span class="go">* f6ec7b7 let us try with some cilantro</span>
</span><span class="go">* e7cf023 (main) don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The branch <code class="docutils literal notranslate"><span class="pre">experiment</span></code> is two commits ahead of <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>We commit our changes to this branch.</p></li>
</ul>
</section>
<section id="exercise-create-and-commit-to-branches">
<span id="exercise-branches"></span><h3>Exercise: Create and commit to branches<a class="headerlink" href="#exercise-create-and-commit-to-branches" title="Link to this heading"></a></h3>
<div class="admonition-branch-1-create-and-commit-to-branches exercise important admonition" id="exercise-0">
<p class="admonition-title">Branch-1: Create and commit to branches</p>
<p>In this exercise, you will create another new branch and few more commits.
We will use this in the next section, to practice
merging. <strong>The goal of the exercise is to end up with 3 branches</strong>.</p>
<ul>
<li><p>Change to the branch <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Create another branch called <code class="docutils literal notranslate"><span class="pre">less-salt</span></code>.</p>
<ul>
<li><p>Note! makes sure you are on main branch when you create the <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> branch.</p></li>
<li><p>A safer way would be to explicitly mention to create from the main branch
as shown below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>less-salt<span class="w"> </span>main
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>Switch to the <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> branch.</p></li>
<li><p>On the <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> branch reduce the amount of salt.</p></li>
<li><p>Commit your changes to the <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> branch.</p></li>
</ul>
<p>Use the same commands as we used above.</p>
<p>We now have three branches (in this case <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> points to <code class="docutils literal notranslate"><span class="pre">less-salt</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch

<span class="go">  experiment</span>
<span class="go">* less-salt</span>
<span class="go">  main</span>

<span class="gp">$ </span>git<span class="w"> </span>graph

<span class="go">* bf28166 (HEAD -&gt; less-salt) reduce amount of salt</span>
<span class="go">| * bcb8b78 (experiment) maybe little bit less cilantro</span>
<span class="go">| * f6ec7b7 let us try with some cilantro</span>
<span class="go">|/</span>
<span class="go">* e7cf023 (main) don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<p>Here is a graphical representation of what we have created:</p>
<figure class="align-default">
<img alt="_images/git-branch-2.svg" src="_images/git-branch-2.svg" /></figure>
<ul>
<li><p>Now switch to <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>In a new commit, improve the <code class="docutils literal notranslate"><span class="pre">README.md</span></code> file (we added the word “Guacamole”):</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Guacamole recipe</span>

This is an exercise repository.
</pre></div>
</div>
</li>
</ul>
<p>Now you should have this situation:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph

<span class="go">* b4af65b (HEAD -&gt; main) improve the documentation</span>
<span class="go">| * bf28166 (less-salt) reduce amount of salt</span>
<span class="go">|/</span>
<span class="go">| * bcb8b78 (experiment) maybe little bit less cilantro</span>
<span class="go">| * f6ec7b7 let us try with some cilantro</span>
<span class="go">|/</span>
<span class="go">* e7cf023 don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/git-branch-3.svg" src="_images/git-branch-3.svg" /></figure>
<p>And for comparison this is how it looks <a class="reference external" href="https://github.com/coderefinery/recipe-before-merge/network">on GitHub</a>.</p>
</div>
</section>
<section id="exercise-merging-branches">
<span id="exercise-branches-merging"></span><h3>Exercise: Merging branches<a class="headerlink" href="#exercise-merging-branches" title="Link to this heading"></a></h3>
<p>It turned out that our experiment with cilantro was a good idea.
Our goal now is to merge <code class="docutils literal notranslate"><span class="pre">experiment</span></code> into <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p>
<div class="admonition-branch-2-merge-branches exercise important admonition" id="exercise-1">
<p class="admonition-title">Branch-2: Merge branches</p>
<p>Merge <code class="docutils literal notranslate"><span class="pre">experiment</span></code> and <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> back into <code class="docutils literal notranslate"><span class="pre">main</span></code> following the lesson below
until the point where we start deleting branches.</p>
</div>
<div class="admonition-if-you-got-stuck-in-the-above-exercises-or-joined-later admonition">
<p class="admonition-title">If you got stuck in the above exercises or joined later</p>
<p><strong>If you got stuck in the above exercises or joined later</strong>,
you can apply the commands below.
But <strong>skip this box if you managed to create branches</strong>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>..<span class="w">  </span><span class="c1"># step out of the current directory</span>

<span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/coderefinery/recipe-before-merge.git
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>recipe-before-merge

<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>experiment
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>less-salt
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main

<span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>remove<span class="w"> </span>origin

<span class="gp">$ </span>git<span class="w"> </span>graph
</pre></div>
</div>
<p>Or call a helper to un-stuck it for you.</p>
</div>
<p>First we make sure we are on the branch we wish to merge <strong>into</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch

<span class="go">  experiment</span>
<span class="go">  less-salt</span>
<span class="hll"><span class="go">* main</span>
</span></pre></div>
</div>
<p>Then we merge <code class="docutils literal notranslate"><span class="pre">experiment</span></code> into <code class="docutils literal notranslate"><span class="pre">main</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>experiment
</pre></div>
</div>
<figure class="align-default">
<img alt="_images/git-merge-1.svg" src="_images/git-merge-1.svg" /></figure>
<p>We can verify the result:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph

<span class="go">*   81fcc0c (HEAD -&gt; main) Merge branch &#39;experiment&#39;</span>
<span class="go">|\</span>
<span class="go">| * bcb8b78 (experiment) maybe little bit less cilantro</span>
<span class="go">| * f6ec7b7 let us try with some cilantro</span>
<span class="go">* | b4af65b improve the documentation</span>
<span class="go">|/</span>
<span class="go">| * bf28166 (less-salt) reduce amount of salt</span>
<span class="go">|/</span>
<span class="go">* e7cf023 don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<p>What happens internally when you merge two branches is that Git creates a new
commit, attempts to incorporate changes from both branches and records the
state of all files in the new commit. While a regular commit has one parent, a
merge commit has two (or more) parents.</p>
<p>To view the branches that are merged into the current branch we can use the command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>--merged

<span class="go">  experiment</span>
<span class="go">* main</span>
</pre></div>
</div>
<p>We are also happy with the work on the <code class="docutils literal notranslate"><span class="pre">less-salt</span></code> branch. Let us merge that
one, too, into <code class="docutils literal notranslate"><span class="pre">main</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w">  </span><span class="c1"># make sure you are on main</span>
<span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>less-salt
</pre></div>
</div>
<figure class="align-default" id="id4">
<img alt="Commit graph after merge" src="_images/git-merge-2.svg" /><figcaption>
<p><span class="caption-text">Commit graph after merge.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can verify the result in the terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>graph

<span class="go">*   4e03d4b (HEAD -&gt; main) Merge branch &#39;less-salt&#39;</span>
<span class="go">|\</span>
<span class="go">| * bf28166 (less-salt) reduce amount of salt</span>
<span class="go">* |   81fcc0c Merge branch &#39;experiment&#39;</span>
<span class="go">|\ \</span>
<span class="go">| * | bcb8b78 (experiment) maybe little bit less cilantro</span>
<span class="go">| * | f6ec7b7 let us try with some cilantro</span>
<span class="go">| |/</span>
<span class="go">* / b4af65b improve the documentation</span>
<span class="go">|/</span>
<span class="go">* e7cf023 don&#39;t forget to enjoy</span>
<span class="go">* 79161b6 add half an onion</span>
<span class="go">* a3394e3 adding README</span>
<span class="go">* 3696246 adding instructions</span>
<span class="go">* f146d25 adding ingredients</span>
</pre></div>
</div>
<p>Observe how Git nicely merged the changed amount of salt and the new ingredient <strong>in the same file
without us merging it manually</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat<span class="w"> </span>ingredients.txt

<span class="go">* 1 tbsp cilantro</span>
<span class="go">* 2 avocados</span>
<span class="go">* 1 chili</span>
<span class="go">* 1 lime</span>
<span class="go">* 1 tsp salt</span>
<span class="go">* 1/2 onion</span>
</pre></div>
</div>
<p>If the same file is changed in both branches, Git attempts to incorporate both
changes into the merged file. If the changes overlap then the user has to
manually <em>settle merge conflicts</em> (we will do that later).</p>
</section>
<section id="deleting-branches-safely">
<h3>Deleting branches safely<a class="headerlink" href="#deleting-branches-safely" title="Link to this heading"></a></h3>
<p>Both feature branches are merged:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>--merged

<span class="go">  experiment</span>
<span class="go">  less-salt</span>
<span class="go">* main</span>
</pre></div>
</div>
<p>This means we can delete the branches:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>experiment
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>less-salt
</pre></div>
</div>
<p>This is the result:</p>
<figure class="align-default" id="id5">
<img alt="Commit graph after merged branches were deleted" src="_images/git-deleted-branches.svg" /><figcaption>
<p><span class="caption-text">Commit graph after merged branches were deleted.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We observe that when deleting branches,
only the pointers (“sticky notes”) disappeared, not the commits.</p>
<p>Git will not let you delete a branch which has not been reintegrated unless you
insist using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-D</span></code>. Even then your commits will not be lost but you
may have a hard time finding them as there is no branch pointing to them.</p>
</section>
<section id="optional-exercises-with-branches">
<span id="exercise-branches-optional"></span><h3>Optional exercises with branches<a class="headerlink" href="#optional-exercises-with-branches" title="Link to this heading"></a></h3>
<p>The following exercises are more advanced, absolutely no problem to postpone them to a
few months later. If you give them a go, keep in mind that you might run into conflicts,
which we will learn to resolve in the next section.</p>
<div class="admonition-optional-branch-3-perform-a-fast-forward-merge exercise important admonition" id="exercise-2">
<p class="admonition-title">(optional) Branch-3: Perform a fast-forward merge</p>
<ol class="arabic">
<li><p>Create a new branch from <code class="docutils literal notranslate"><span class="pre">main</span></code> and switch to it.</p></li>
<li><p>Create a couple of commits on the new branch (for instance edit <code class="docutils literal notranslate"><span class="pre">README.md</span></code>):</p>
<figure class="align-default">
<img alt="_images/git-pre-ff.svg" src="_images/git-pre-ff.svg" /></figure>
</li>
<li><p>Now switch to <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Merge the new branch to <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Examine the result with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>.</p></li>
<li><p>Have you expected the result? Discuss what you see.</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>You will see that in this case no merge commit was created and Git merged the
two branches by moving (fast-forwarding) the “main” branch (label) three
commits forward.</p>
<p>This was possible since one branch is the ancestor of the other and their
developments did not diverge.</p>
<p>A merge that does not require any merge commit is a fast-forward merge.</p>
</div>
</div>
<div class="admonition-optional-branch-4-rebase-a-branch-instead-of-merge exercise important admonition" id="exercise-3">
<p class="admonition-title">(optional) Branch-4: Rebase a branch (instead of merge)</p>
<p>As an alternative to merging branches, one can also <em>rebase</em> branches.
Rebasing means that the new commits are <em>replayed</em> on top of another branch
(instead of creating an explicit merge commit).
<strong>Note that rebasing changes history and should not be done on public commits!</strong></p>
<ol class="arabic simple">
<li><p>Create a new branch, and make a couple of commits on it.</p></li>
<li><p>Switch back to <code class="docutils literal notranslate"><span class="pre">main</span></code>, and make a couple of commits on it.</p></li>
<li><p>Inspect the situation with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>.</p></li>
<li><p>Now rebase the new branch on top of <code class="docutils literal notranslate"><span class="pre">main</span></code> by first switching to the new branch, and then <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">main</span></code>.</p></li>
<li><p>Inspect again the situation with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>. Notice that the commit hashes have changed - think about why!</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>You will notice two things:</p>
<ul class="simple">
<li><p>History is now linear and does not contain merge commits.</p></li>
<li><p>All the commit hashes that were on the branch that got rebased, have
changed. This also demonstrates that <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> is a command that alters
history. The commit history looks as if the rebased commits were all done
after the <code class="docutils literal notranslate"><span class="pre">main</span></code> commits.</p></li>
</ul>
</div>
</div>
</section>
<section id="tags">
<h3>Tags<a class="headerlink" href="#tags" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>A tag is a pointer to a commit but in contrast to a branch it <strong>does not ever
move</strong> when creating new commits later.</p></li>
<li><p>It can be useful to think of branches as sticky notes and of tags as
<a class="reference external" href="https://en.wikipedia.org/wiki/Commemorative_plaque">commemorative plaques</a>.</p></li>
<li><p>We use tags to record particular states or milestones of a project at a given
point in time, like for instance versions (have a look at <a class="reference external" href="http://semver.org">semantic versioning</a>,
v1.0.3 is easier to understand and remember than 64441c1934def7d91ff0b66af0795749d5f1954a).</p></li>
<li><p>There are two basic types of tags: annotated and lightweight.</p></li>
<li><p><strong>Use annotated tags</strong> since they contain the author and can be cryptographically signed using
GPG, timestamped, and a message attached.</p></li>
</ul>
<p>Let’s add an annotated tag to our current state of the guacamole recipe:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>tag<span class="w"> </span>-a<span class="w"> </span>nobel-2023<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;recipe I made for the 2023 Nobel banquet&quot;</span>
</pre></div>
</div>
<p>As you may have found out already, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> is a very versatile command. Try this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>show<span class="w"> </span>nobel-2023
</pre></div>
</div>
<p>For more information about tags see for example
<a class="reference external" href="https://git-scm.com/book/en/v2/Git-Basics-Tagging">the Pro Git book</a> chapter on the
subject.</p>
</section>
<hr class="docutils" />
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h3>
<p>Let us pause for a moment and recapitulate what we have just learned:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w">               </span><span class="c1"># see where we are</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>NAME<span class="w">          </span><span class="c1"># create branch NAME</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>NAME<span class="w">          </span><span class="c1"># switch to branch NAME</span>
<span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>NAME<span class="w">           </span><span class="c1"># merge branch NAME (to current branch)</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>NAME<span class="w">       </span><span class="c1"># delete branch NAME</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>NAME<span class="w">       </span><span class="c1"># delete unmerged branch NAME</span>
</pre></div>
</div>
<p>Since the following command combo is so frequent:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>NAME<span class="w">          </span><span class="c1"># create branch NAME</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>NAME<span class="w">          </span><span class="c1"># switch to branch NAME</span>
</pre></div>
</div>
<p>There is a shortcut for it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>NAME<span class="w">  </span><span class="c1"># create branch NAME and switch to it</span>
</pre></div>
</div>
<section id="typical-workflows">
<h4>Typical workflows<a class="headerlink" href="#typical-workflows" title="Link to this heading"></a></h4>
<p>With this there are two typical workflows:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>new-feature<span class="w">  </span><span class="c1"># create branch, switch to it</span>
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w">                       </span><span class="c1"># work, work, work, ..., and test</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main<span class="w">                  </span><span class="c1"># once feature is ready, switch to main</span>
<span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>new-feature<span class="w">            </span><span class="c1"># merge work to main</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>new-feature<span class="w">        </span><span class="c1"># remove branch</span>
</pre></div>
</div>
<p>Sometimes you have a wild idea which does not work.
Or you want some throw-away branch for debugging:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>wild-idea<span class="w">    </span><span class="c1"># create branch, switch to it, work, work, work ...</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main<span class="w">                  </span><span class="c1"># realize it was a bad idea, back to main</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>wild-idea<span class="w">          </span><span class="c1"># it is gone, off to a new idea</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="admonition-branch-5-test-your-understanding exercise important admonition" id="exercise-4">
<p class="admonition-title">Branch-5: Test your understanding</p>
<p>Which of the following combos (one or more) creates a new branch and makes a commit to it?</p>
<ol class="arabic">
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>new-branch
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>file.txt
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>file.txt
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>new-branch
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>new-branch
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>new-branch
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>file.txt
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
</li>
<li><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>new-branch
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>file.txt
<span class="gp">$ </span>git<span class="w"> </span>commit
</pre></div>
</div>
</li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>Both 2 and 3 would do the job. Note that in 2 we first stage the file, and then create the
branch and commit to it. In 1 we create the branch but do not switch to it, while in 4 we
don’t give the <code class="docutils literal notranslate"><span class="pre">--create</span></code> flag to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span></code> to create the new branch.</p>
</div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>A branch is a division unit of work, to be merged with other units of work.</p></li>
<li><p>A tag is a pointer to a moment in the history of a project.</p></li>
</ul>
</div>
</section>
</section>
</section>
<span id="document-conflicts"></span><section id="conflict-resolution">
<span id="id1"></span><h2>Conflict resolution<a class="headerlink" href="#conflict-resolution" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand merge conflicts sufficiently well to be able to fix them.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>20 min teaching/type-along</p></li>
<li><p>20 min exercise</p></li>
</ul>
</div>
<section id="conflicts-in-git-and-why-they-are-good">
<h3>Conflicts in Git and why they are good<a class="headerlink" href="#conflicts-in-git-and-why-they-are-good" title="Link to this heading"></a></h3>
<p>Imagine we start with the following text file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">tbsp</span> <span class="n">cilantro</span>
<span class="mi">2</span> <span class="n">avocados</span>
<span class="mi">1</span> <span class="n">chili</span>
<span class="mi">1</span> <span class="n">lime</span>
<span class="mi">1</span> <span class="n">tsp</span> <span class="n">salt</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="n">onion</span>
</pre></div>
</div>
<p>On branch A somebody modifies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="mi">2</span> <span class="n">tbsp</span> <span class="n">cilantro</span>
</span><span class="mi">2</span> <span class="n">avocados</span>
<span class="mi">1</span> <span class="n">chili</span>
<span class="hll"><span class="mi">2</span> <span class="n">lime</span>
</span><span class="mi">1</span> <span class="n">tsp</span> <span class="n">salt</span>
<span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="n">onion</span>
</pre></div>
</div>
<p>On branch B somebody else modifies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="n">tbsp</span> <span class="n">cilantro</span>
</span><span class="mi">2</span> <span class="n">avocados</span>
<span class="mi">1</span> <span class="n">chili</span>
<span class="mi">1</span> <span class="n">lime</span>
<span class="mi">1</span> <span class="n">tsp</span> <span class="n">salt</span>
<span class="hll"><span class="mi">1</span> <span class="n">onion</span>
</span></pre></div>
</div>
<p>When we try to merge Git will figure out that we 2 limes and an entire onion
but does not know whether to reduce or increase the amount of cilantro:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="hll">?????????????????
</span>2 avocados
1 chili
2 lime
1 tsp salt
1 onion
</pre></div>
</div>
<p>Git is very good at resolving modifications when merging branches and
in most cases a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code> runs smooth and automatic.
Then a merge commit appears (unless fast-forward; see <a class="reference internal" href="index.html#exercise-branches-optional"><span class="std std-ref">Optional exercises with branches</span></a>) without you even noticing.</p>
<p>But sometimes the <strong>same portion</strong> of the code/text is modified on two branches
<strong>in two different ways</strong> and Git issues a <strong>conflict</strong>.
Then you need to tell Git which version to keep (<strong>resolve</strong> it).</p>
<p>There are several ways to do that as we will see.</p>
<p>Please remember:</p>
<ul class="simple">
<li><p>It is good that Git conflicts exist: Git will not silently overwrite one of
two differing modifications.</p></li>
<li><p>Conflicts may look scary, but are not that bad after a little bit of
practice. Also they are luckily rare.</p></li>
<li><p>Don’t be afraid of Git because of conflicts. You may not meet some conflicts
using other systems because you simply can’t do the kinds of things you do
in Git.</p></li>
<li><p>You can take human measures to reduce them.</p></li>
</ul>
<hr class="docutils" />
<div class="admonition-the-human-side-of-conflicts discussion important admonition" id="discussion-0">
<p class="admonition-title">The human side of conflicts</p>
<ul class="simple">
<li><p>What does it mean if two people do the same thing in two different ways?</p></li>
<li><p>What if you work on the same file but do two different things in the different sections?</p></li>
<li><p>What if you do something, don’t tell someone from 6 months, and then try to combine it with other people’s work?</p></li>
<li><p>How are conflicts avoided in other work? (Only one person working at once?
Declaring what you are doing before you start, if there is any chance someone
else might do the same thing, helps.)</p></li>
<li><p>Minor conflicts (two people revise spelling) vs semantic (two people rewrite
a function to add two different new features). How did Git solve these in
branching/merging easily?</p></li>
</ul>
</div>
<p>Now we can go to show how Git controls when there is actually a conflict.</p>
</section>
<section id="preparing-a-conflict">
<h3>Preparing a conflict<a class="headerlink" href="#preparing-a-conflict" title="Link to this heading"></a></h3>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<p>We do the following together as type-along/demo.</p>
</div>
<div class="admonition-if-you-got-stuck-previously-or-joined-later admonition">
<p class="admonition-title">If you got stuck previously or joined later</p>
<p><strong>If you got stuck previously or joined later</strong>,
you can apply the commands below.
But <strong>skip this box if you managed to create branches</strong>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>..<span class="w">  </span><span class="c1"># step out of the current directory</span>

<span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/coderefinery/recipe-before-merge.git
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>recipe-before-merge

<span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>remove<span class="w"> </span>origin

<span class="gp">$ </span>git<span class="w"> </span>graph
</pre></div>
</div>
<p>Or call a helper to un-stuck it for you.</p>
</div>
<p>We will make two branches, make two conflicting changes (both increase and
decrease the amount of cilantro), and later we will try to merge them
together.</p>
<ul>
<li><p>Create two branches from <code class="docutils literal notranslate"><span class="pre">main</span></code>: one called <code class="docutils literal notranslate"><span class="pre">like-cilantro</span></code>, one called <code class="docutils literal notranslate"><span class="pre">dislike-cilantro</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>like-cilantro<span class="w"> </span>main
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>dislike-cilantro<span class="w"> </span>main
</pre></div>
</div>
</li>
<li><p>On the two branches make <strong>different modifications</strong> to the amount of the <strong>same ingredient</strong>:</p></li>
<li><p>On the branch <code class="docutils literal notranslate"><span class="pre">like-cilantro</span></code> we have the following change:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff<span class="w"> </span>main<span class="w"> </span>like-cilantro
</pre></div>
</div>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/ingredients.txt b/ingredients.txt</span>
<span class="gh">index e83294b..6cacd50 100644</span>
<span class="gd">--- a/ingredients.txt</span>
<span class="gi">+++ b/ingredients.txt</span>
<span class="gu">@@ -1,4 +1,4 @@</span>
<span class="gd">-* 1 tbsp cilantro</span>
<span class="gi">+* 2 tbsp cilantro</span>
<span class="w"> </span>* 2 avocados
<span class="w"> </span>* 1 chili
<span class="w"> </span>* 1 lime
</pre></div>
</div>
</li>
<li><p>And on the branch <code class="docutils literal notranslate"><span class="pre">dislike-cilantro</span></code> we have the following change:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff<span class="w"> </span>main<span class="w"> </span>dislike-cilantro
</pre></div>
</div>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --git a/ingredients.txt b/ingredients.txt</span>
<span class="gh">index e83294b..6484462 100644</span>
<span class="gd">--- a/ingredients.txt</span>
<span class="gi">+++ b/ingredients.txt</span>
<span class="gu">@@ -1,4 +1,4 @@</span>
<span class="gd">-* 1 tbsp cilantro</span>
<span class="gi">+* 1/2 tbsp cilantro</span>
<span class="w"> </span>* 2 avocados
<span class="w"> </span>* 1 chili
<span class="w"> </span>* 1 lime
</pre></div>
</div>
</li>
</ul>
</section>
<section id="merging-conflicting-changes">
<h3>Merging conflicting changes<a class="headerlink" href="#merging-conflicting-changes" title="Link to this heading"></a></h3>
<p>What do you expect will happen when we try to merge these two branches into
main?</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span></code> does not work, your Git version might be older than from 2019.
On older Git it is <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span></code>.</p>
</div>
<p>The first merge will work:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main
<span class="gp">$ </span>git<span class="w"> </span>status
<span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>like-cilantro

<span class="go">Updating 4e03d4b..3caa632</span>
<span class="go">Fast-forward</span>
<span class="go"> ingredients.txt | 2 +-</span>
<span class="go"> 1 file changed, 1 insertion(+), 1 deletion(-)</span>
</pre></div>
</div>
<p>But the second will fail:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>dislike-cilantro

<span class="go">Auto-merging ingredients.txt</span>
<span class="go">CONFLICT (content): Merge conflict in ingredients.txt</span>
<span class="go">Automatic merge failed; fix conflicts and then commit the result.</span>
</pre></div>
</div>
<p>Without conflict Git would have automatically created a merge commit,
but since there is a conflict, Git did not commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status

<span class="go">You have unmerged paths.</span>
<span class="go">  (fix conflicts and run &quot;git commit&quot;)</span>
<span class="go">  (use &quot;git merge --abort&quot; to abort the merge)</span>

<span class="go">Unmerged paths:</span>
<span class="go">  (use &quot;git add &lt;file&gt;...&quot; to mark resolution)</span>
<span class="hll"><span class="go">	both modified:   ingredients.txt</span>
</span>
<span class="go">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span>
</pre></div>
</div>
<p>Git won’t decide which to take and we need to decide.  Observe how Git gives
us clear instructions on how to move forward.</p>
<p>Let us inspect the conflicting file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat<span class="w"> </span>ingredients.txt

<span class="go">&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span>
<span class="go">* 2 tbsp cilantro</span>
<span class="go">=======</span>
<span class="go">* 1/2 tbsp cilantro</span>
<span class="go">&gt;&gt;&gt;&gt;&gt;&gt;&gt; dislike-cilantro</span>
<span class="go">* 2 avocados</span>
<span class="go">* 1 chili</span>
<span class="go">* 1 lime</span>
<span class="go">* 1 tsp salt</span>
<span class="go">* 1/2 onion</span>
</pre></div>
</div>
<p>Git inserted resolution markers (the <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">=======</span></code>).</p>
<p>Try also <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>diff
</pre></div>
</div>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gh">diff --cc ingredients.txt</span>
<span class="gh">index 6cacd50,6484462..0000000</span>
<span class="gd">--- a/ingredients.txt</span>
<span class="gi">+++ b/ingredients.txt</span>
<span class="gu">@@@ -1,4 -1,4 +1,10 @@@</span>
<span class="gi">++&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</span>
<span class="w"> </span>+* 2 tbsp cilantro
<span class="gi">++=======</span>
<span class="gi">+ * 1/2 tbsp cilantro</span>
<span class="gi">++&gt;&gt;&gt;&gt;&gt;&gt;&gt; dislike-cilantro</span>
<span class="w"> </span> * 2 avocados
<span class="w"> </span> * 1 chili
<span class="w"> </span> * 1 lime
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code> now only shows the conflicting part, nothing else.</p>
</section>
<section id="id2">
<h3>Conflict resolution<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">HEAD</span>
<span class="o">*</span> <span class="mi">2</span> <span class="n">tbsp</span> <span class="n">cilantro</span>
<span class="o">=======</span>
<span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="n">tbsp</span> <span class="n">cilantro</span>
<span class="o">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="n">dislike</span><span class="o">-</span><span class="n">cilantro</span>
</pre></div>
</div>
<p>We have to edit the code/text between the resolution markers.  You
only have to care about what Git shows you: Git stages all files
without conflicts and leaves the files with conflicts unstaged.</p>
<div class="admonition-steps-to-resolve-a-conflict admonition">
<p class="admonition-title">Steps to resolve a conflict</p>
<ul class="simple">
<li><p>Check status with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>.</p></li>
<li><p>Decide what you keep (the one, the other, or both or something
else).  Edit the file to do this.</p>
<ul>
<li><p>Remove the resolution markers, if not already done.</p></li>
<li><p>The file(s) should now look exactly how you want them.</p></li>
</ul>
</li>
<li><p>Check status with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>.</p></li>
<li><p>Tell Git that you have resolved the conflict with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">ingredients.txt</span></code>
(if you use the Emacs editor with a certain plugin the editor may stage the
change for you after you have removed the conflict markers).</p></li>
<li><p>Verify the result with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>.</p></li>
<li><p>Finally commit the merge with only <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>. Everything is pre-filled.</p></li>
</ul>
</div>
</section>
<section id="exercise-create-and-resolve-a-conflict">
<span id="exercise-conflicts"></span><h3>Exercise: Create and resolve a conflict<a class="headerlink" href="#exercise-create-and-resolve-a-conflict" title="Link to this heading"></a></h3>
<div class="admonition-conflict-1-create-another-conflict-and-resolve exercise important admonition" id="exercise-0">
<p class="admonition-title">Conflict-1: Create another conflict and resolve</p>
<p>In this exercise, we repeat almost exactly what we did above with a
different ingredient.</p>
<ol class="arabic simple">
<li><p>Create two branches before making any modifications.</p></li>
<li><p>Again modify some ingredient on both branches.</p></li>
<li><p>Merge one, merge the other and observe a conflict, resolve the conflict and commit the merge.</p></li>
<li><p>What happens if you apply the same modification on both branches?</p></li>
<li><p>If you create a branch <code class="docutils literal notranslate"><span class="pre">like-avocados</span></code>, commit a change, then from this
branch create another banch <code class="docutils literal notranslate"><span class="pre">dislike-avocados</span></code>, commit again, and try to
merge both branches into <code class="docutils literal notranslate"><span class="pre">main</span></code> you will not see a conflict. Can you
explain, why it is different this time?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>4: No conflict in this case if the change is the same.</p>
<p>5: No conflict in this case since in Git history one change happened after the other. The two changes
are related and linked by Git history and one is a Git ancestor of the
other. Git will assume that since we applied one change after the other,
we meant this. There is nothing to resolve.</p>
</div>
</div>
</section>
<section id="optional-exercises-with-conflict-resolution">
<span id="exercise-conflicts-optional"></span><h3>Optional exercises with conflict resolution<a class="headerlink" href="#optional-exercises-with-conflict-resolution" title="Link to this heading"></a></h3>
<div class="admonition-optional-conflict-2-resolve-a-conflict-when-rebasing-a-branch exercise important admonition" id="exercise-1">
<p class="admonition-title">(optional) Conflict-2: Resolve a conflict when rebasing a branch</p>
<ol class="arabic simple">
<li><p>Create two branches where you anticipate a conflict.</p></li>
<li><p>Try to merge them and observe that indeed they conflict.</p></li>
<li><p>Abort the merge with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">--abort</span></code>.</p></li>
<li><p>What do you expect will happen if you rebase one branch on top of the
other? Do you anticipate a conflict? Try it out.</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<p>Yes, this will conflict. If it conflicts during a merge, it will also conflict
during rebase but the conflict resolution looks slightly different:
You still need to look for conflict markers but you tell Git that you resolved
a conflict with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> and then you continue with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span> <span class="pre">--continue</span></code>.
Follow instructions that you get from the Git command line.</p>
</div>
</div>
<div class="admonition-optional-conflict-3-resolve-a-conflict-using-mergetool exercise important admonition" id="exercise-2">
<p class="admonition-title">(optional) Conflict-3: Resolve a conflict using mergetool</p>
<ul>
<li><p>Again create a conflict (for instance disagree on the number of avocados).</p></li>
<li><p>Stop at this stage:</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span>Auto-merging ingredients.txt
CONFLICT (content): Merge conflict in ingredients.txt
Automatic merge failed; fix conflicts and then commit the result.
</pre></div>
</div>
</li>
<li><p>Instead of resolving the conflict manually, use a visual tool
(requires installing one of the <a class="reference external" href="https://coderefinery.github.io/installation/difftools/">visual diff tools</a>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>mergetool
</pre></div>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/mergetool.png"><img alt="Conflict resolution using mergetool" src="_images/mergetool.png" style="width: 100%;" /></a>
</figure>
</li>
<li><p>Your current branch is left, the branch you merge is right, result is in the middle.</p></li>
<li><p>After you are done, close and commit, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> is not needed when using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">mergetool</span></code>.</p></li>
</ul>
<p>If you have not instructed Git to avoid creating backups when using mergetool, then to be on
the safe side there will be additional temporary files created. To remove those  you can do
a git clean after the merging.</p>
<p>To view what will be removed:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clean<span class="w"> </span>-n
</pre></div>
</div>
<p>To remove:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clean<span class="w"> </span>-f
</pre></div>
</div>
<p>To configure Git to avoid creating backups at all:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>mergetool.keepBackup<span class="w"> </span><span class="nb">false</span>
</pre></div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="using-ours-or-theirs-strategy">
<h3>Using “ours” or “theirs” strategy<a class="headerlink" href="#using-ours-or-theirs-strategy" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Sometimes you know that you want to keep “ours” version (version on the branch you are on)
or “theirs” (version on the merged branch).</p></li>
<li><p>Then you do not have to resolve conflicts manually.</p></li>
<li><p>See <a class="reference external" href="https://git-scm.com/docs/merge-strategies">merge strategies</a>.</p></li>
</ul>
<p>Example (merge and in doubt take the changes from current branch):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>-s<span class="w"> </span>recursive<span class="w"> </span>-Xours<span class="w"> </span>less-avocados
</pre></div>
</div>
<p>Or (merge and in doubt take the changes from less-avocados branch):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>-s<span class="w"> </span>recursive<span class="w"> </span>-Xtheirs<span class="w"> </span>less-avocados
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="aborting-a-conflicting-merge">
<h3>Aborting a conflicting merge<a class="headerlink" href="#aborting-a-conflicting-merge" title="Link to this heading"></a></h3>
<p>Sometimes you get a merge conflict but realize that you can’t solve it without
talking to a colleague (who created the other change) first. What to do?</p>
<p>You can abort the merge and postponing conflict resolution by resetting the
repository to <code class="docutils literal notranslate"><span class="pre">HEAD</span></code> (last committed state):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>merge<span class="w"> </span>--abort
</pre></div>
</div>
<p>The repository looks then exactly as it was before the merge.</p>
</section>
<hr class="docutils" />
<section id="avoiding-conflicts">
<h3>Avoiding conflicts<a class="headerlink" href="#avoiding-conflicts" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Human measures</p>
<ul>
<li><p>Think and plan to which branch you will commit to.</p></li>
<li><p>Do not put unrelated changes on the same branch.</p></li>
</ul>
</li>
<li><p>Collaboration measures</p>
<ul>
<li><p>Open an issue and discuss with collaborators before starting a long-living
branch.</p></li>
</ul>
</li>
<li><p>Project layout measures</p>
<ul>
<li><p>Modifying global data often causes conflicts.</p></li>
<li><p>Modular programming reduces this risk.</p></li>
</ul>
</li>
<li><p>Technical measures</p>
<ul>
<li><p><strong>Share your changes early and often</strong> - this is one of the happy,
rare circumstances when everyone doing the selfish thing (e.g. <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> as
early as practical) results in best case for everyone!</p></li>
<li><p>Pull/rebase often to keep up to date with upstream.</p></li>
<li><p>Resolve conflicts early.</p></li>
</ul>
</li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<p>Discuss how Git handles conflicts compared to services like Google Drive.</p>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Conflicts often appear because of not enough communication or not optimal
branching strategy.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-remotes"></span><section id="sharing-repositories-online">
<h2>Sharing repositories online<a class="headerlink" href="#sharing-repositories-online" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>We get a feeling for remote repositories (<a class="reference external" href="https://coderefinery.github.io/git-collaborative/">more later</a>).</p></li>
<li><p>We are able to publish a repository on the web.</p></li>
<li><p>We are able to fetch and track a repository from the web.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>15 min demonstration/type-along</p></li>
<li><p>25 min exercise</p></li>
</ul>
</div>
<section id="from-our-laptops-to-the-web">
<h3>From our laptops to the web<a class="headerlink" href="#from-our-laptops-to-the-web" title="Link to this heading"></a></h3>
<p>We have seen that <strong>creating Git repositories and moving them around is
relatively simple</strong> and that is great.</p>
<p>So far, if you only worked in the command line, everything was local and all
snapshots, branches, and tags are saved under <code class="docutils literal notranslate"><span class="pre">.git</span></code>.</p>
<p>If we remove <code class="docutils literal notranslate"><span class="pre">.git</span></code>, we remove all Git history of a project.</p>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>What if the hard disk fails?</p></li>
<li><p>What if somebody steals my laptop?</p></li>
<li><p>How can we collaborate with others across the web?</p></li>
</ul>
</div>
</section>
<section id="remotes">
<h3>Remotes<a class="headerlink" href="#remotes" title="Link to this heading"></a></h3>
<p>We will learn how to work with remote repositories in detail in the
<a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative distributed version control</a> lesson.</p>
<p>In this section we only want to get a taste to prepare us for other lessons
where we will employ GitHub.  Our goal is to publish our exercise guacamole recipe
which we prepared in the previous episodes on
the web. Don’t worry, you will be able to remove it afterwards.</p>
<div class="admonition-if-you-don-t-have-the-recipe-repository-from-previous-episodes admonition">
<p class="admonition-title">If you don’t have the recipe repository from previous episodes</p>
<p>Maybe you joined the workshop later or got stuck somewhere? <strong>No problem</strong>!</p>
<p><strong>If you don’t have the recipe repository from previous episodes</strong>, you can
clone our version of the repository using (please <strong>skip this if you have the recipe
repository on your computer already</strong>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/coderefinery/recipe-before-merge.git<span class="w"> </span>recipe
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>recipe
<span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>remove<span class="w"> </span>origin
</pre></div>
</div>
<p>Now you have a repository called <code class="docutils literal notranslate"><span class="pre">recipe</span></code> on your computer with a couple of
commits. Further down we will also clarify what <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code> does.</p>
</div>
<p>To store your git data on another server, you use <strong>remotes</strong>.
A remote is a repository on its own, with its own branches
We can <strong>push</strong> changes to the remote and <strong>pull</strong>
from the remote.</p>
<p>You might use remotes to:</p>
<ul class="simple">
<li><p>Back up your own work.</p></li>
<li><p>To collaborate with other people.</p></li>
</ul>
<p>There are different types of remotes:</p>
<ul class="simple">
<li><p>If you have a server you can ssh to, you can use that as a remote.</p></li>
<li><p><a class="reference external" href="https://github.com">GitHub</a> is a popular, closed-source commercial site.</p></li>
<li><p><a class="reference external" href="https://about.gitlab.com">GitLab</a> is a popular, open-core
commercial site.  Many universities have their own private GitLab servers
set up.</p></li>
<li><p><a class="reference external" href="https://bitbucket.org">Bitbucket</a> is yet another popular commercial site.</p></li>
<li><p>Another option is <a class="reference external" href="https://notabug.org">NotABug</a>.</p></li>
<li><p>We also operate a <a class="reference external" href="https://coderefinery.org/repository/">Nordic
research software repository
platform</a>.
This is GitLab, free for researchers and allows private,
cross-university sharing.</p></li>
</ul>
<hr class="docutils" />
</section>
<section id="authenticating-to-github-ssh-or-https">
<span id="clone-method"></span><h3>Authenticating to GitHub: SSH or HTTPS?<a class="headerlink" href="#authenticating-to-github-ssh-or-https" title="Link to this heading"></a></h3>
<p><strong>How does Github know who you are?</strong>  This is hard and there are two
options.</p>
<ul class="simple">
<li><p><strong>SSH</strong> is the classic method, using Secure Shell remote connection
keys.</p></li>
<li><p><strong>HTTPS</strong> works with the <strong>Git Credential Manager</strong>, which is an
extra add-on that works easily in Windows and Mac.</p></li>
</ul>
<p>Read how to install them from the <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">installation
instructions</a>.</p>
<p>Test which one you should use:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-U1NI" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-U1NI" name="U1NI" role="tab" tabindex="0">SSH</button><button aria-controls="panel-0-SFRUUFM=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-SFRUUFM=" name="SFRUUFM=" role="tab" tabindex="-1">HTTPS</button></div><div aria-labelledby="tab-0-U1NI" class="sphinx-tabs-panel group-tab" id="panel-0-U1NI" name="U1NI" role="tabpanel" tabindex="0"><p>Try this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ssh<span class="w"> </span>-T<span class="w"> </span>git@github.com
</pre></div>
</div>
<p>If it returns <code class="docutils literal notranslate"><span class="pre">Hi</span> <span class="pre">USERNAME!</span> <span class="pre">You've</span> <span class="pre">successfully</span> <span class="pre">authenticated,</span> <span class="pre">...</span></code>,
then SSH is configured and the following steps will work with the SSH
cloning.</p>
<p>See our <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">installation
instructions</a> to
set up SSH access.</p>
<p><strong>From now on, if you know that SSH works, you should always select
SSH as the clone URL from GitHub, or translate the URL to start with
the right thing yourself:</strong> <code class="docutils literal notranslate"><span class="pre">git&#64;github.com:</span></code> (with the trailing
<code class="docutils literal notranslate"><span class="pre">:</span></code>).</p>
</div><div aria-labelledby="tab-0-SFRUUFM=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-SFRUUFM=" name="SFRUUFM=" role="tabpanel" tabindex="0"><p>Try this command:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--get<span class="w"> </span>credential.helper
</pre></div>
</div>
<p>If this shows something, then the credential manager is probably
configured and HTTPS cloning will work (but you can’t verify it until
you try using it).</p>
<p>From now on, <strong>if you know that HTTPS works, you should always select
HTTPS as the clone URL from Github, or translate the URL to start with
the right thing yourself:</strong> <code class="docutils literal notranslate"><span class="pre">https://github.com/</span></code></p>
</div></div>
<p>If you do not have these configured, please watch as we do this episode and you
can check the <a class="reference external" href="https://coderefinery.github.io/installation/ssh/">installation
instructions</a>
before the next <a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative Git
lesson</a>, where we will need
one of these set up.</p>
</section>
<hr class="docutils" />
<section id="publishing-an-existing-repository-from-laptop-to-github">
<h3>Publishing an existing repository from laptop to GitHub<a class="headerlink" href="#publishing-an-existing-repository-from-laptop-to-github" title="Link to this heading"></a></h3>
<div class="admonition-if-you-started-in-the-browser-and-have-nothing-on-your-laptop-yet admonition">
<p class="admonition-title">If you started in the browser and have nothing on your laptop yet</p>
<p>It is possible, that you already have a repository on GitHub if you followed
the examples and exercises in previous episodes in the browser. In this case,
please watch others publish their repository and try to clone your repository
to the laptop using instructions at the bottom of this page.</p>
</div>
<p>First log into GitHub, then follow the screenshots and descriptions below.</p>
<figure class="align-default" id="id1">
<a class="with-border reference internal image-reference" href="_images/new-repo-plus.png"><img alt="Screenshot on GitHub before a new repository form is opened" class="with-border" src="_images/new-repo-plus.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Click on the “plus” symbol on top right, then on “New repository”.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Another way to create a new repository is to visit
<a class="reference external" href="https://github.com/new">https://github.com/new</a> directly.</p>
<figure class="align-default" id="id2">
<a class="with-border reference internal image-reference" href="_images/new-bare-repo-form.png"><img alt="Screenshot on GitHub just before a new repository is created" class="with-border" src="_images/new-bare-repo-form.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Choose a repository name, add a short description, but please <strong>do not check</strong> “Add a
README file”**. For “Add .gitignore” and “Choose a license” also leave as “None”. Finally “Create repository”.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once you click the green “Create repository”, you will see a page similar to:</p>
<figure class="align-default">
<a class="with-border reference internal image-reference" href="_images/bare-repo.png"><img alt="Screenshot on GitHub after a bare repository was created" class="with-border" src="_images/bare-repo.png" style="width: 100%;" /></a>
</figure>
<p>What this means is that we have now an empty project with either an HTTPS or an
SSH address: click on the HTTPS and SSH buttons to see what happens.</p>
<p>We now want to follow the “<strong>… or push an existing repository from the command line</strong>:</p>
<ol class="arabic simple">
<li><p>Now go to your guacamole repository on your computer.</p></li>
<li><p>Check that you are in the right place with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>.</p></li>
<li><p>Copy paste the three lines to the terminal and execute those, in my case (<strong>you
need to replace the “USER” part and possibly also the repository name</strong>):</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-U1NI" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-U1NI" name="U1NI" role="tab" tabindex="0">SSH</button><button aria-controls="panel-1-SFRUUFM=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-SFRUUFM=" name="SFRUUFM=" role="tab" tabindex="-1">HTTPS</button></div><div aria-labelledby="tab-1-U1NI" class="sphinx-tabs-panel group-tab" id="panel-1-U1NI" name="U1NI" role="tabpanel" tabindex="0"><p>See above for if SSH is the right option for you.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>git@github.com:USER/recipe.git
</pre></div>
</div>
</div><div aria-labelledby="tab-1-SFRUUFM=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-SFRUUFM=" name="SFRUUFM=" role="tabpanel" tabindex="0"><p>See above for if HTTPS is the right option for you.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>https://github.com/USER/recipe.git
</pre></div>
</div>
</div></div>
<p>Then:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-M<span class="w"> </span>main
<span class="gp">$ </span>git<span class="w"> </span>push<span class="w"> </span>-u<span class="w"> </span>origin<span class="w"> </span>main
</pre></div>
</div>
<p>The meaning of the above lines:</p>
<ul class="simple">
<li><p>Add a remote reference with the name “origin”</p></li>
<li><p>Rename current branch to “main”</p></li>
<li><p>Push branch “main” to “origin”</p></li>
</ul>
<p>You should now see:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Enumerating objects: 3, done.
Counting objects: 100% (3/3), done.
Writing objects: 100% (3/3), 221 bytes | 221.00 KiB/s, done.
Total 3 (delta 0), reused 0 (delta 0), pack-reused 0
To github.com:USER/recipe.git
 * [new branch]      main -&gt; main
Branch &#39;main&#39; set up to track remote branch &#39;main&#39; from &#39;origin&#39;.
</pre></div>
</div>
<p><strong>Reload your GitHub project website</strong> and - taa-daa - your commits should now be
online! What just happened? <strong>Think of publishing a repository as uploading
the <code class="docutils literal notranslate"><span class="pre">.git</span></code> part online</strong>.</p>
<div class="admonition-troubleshooting admonition">
<p class="admonition-title">Troubleshooting</p>
<p><strong>error: remote origin already exists.</strong></p>
<ul class="simple">
<li><p>Explanation: You probably ran a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command, then changed your
mind about HTTPS or SSH and then tried to run the other <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command but “origin” then already exists.</p></li>
<li><p>Recovery:</p>
<ul>
<li><p>First remove “origin” with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">remove</span> <span class="pre">origin</span></code></p></li>
<li><p>Then run the correct <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">add</span> <span class="pre">origin</span> <span class="pre">...</span></code> command</p></li>
</ul>
</li>
</ul>
<p><strong>remote contains work that you do not have</strong></p>
<ul class="simple">
<li><p>Explanation: You probably clicked on “Add a README file” and now the
repository on GitHub is not empty but contains one commit and locally you
have a different history. Git now prevents you from accidentally overwriting
the history on GitHub.</p></li>
<li><p>Recovery:</p>
<ul>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>, which will force Git to overwrite the history on GitHub</p></li>
<li><p>Note that this is a powerful but also possibly dangerous option but here it
helps us. If it’s a brand new repo, it probably is fine to do this. For real
repositories, don’t do this unless you are very sure what is happening.</p></li>
</ul>
</li>
</ul>
</div>
</section>
<hr class="docutils" />
<section id="cloning-a-repository-from-github-to-laptop">
<h3>Cloning a repository from GitHub to laptop<a class="headerlink" href="#cloning-a-repository-from-github-to-laptop" title="Link to this heading"></a></h3>
<p>Now other people can clone this repository and contribute changes. In the
<a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative distributed version control</a> lesson
we will learn how this works.</p>
<p>At this point only a brief demo - if you copy the SSH or HTTPS address, you can clone repositories like this
(again adapt the <code class="docutils literal notranslate"><span class="pre">USER</span></code> in the “USER/repository.git” part):</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-U1NI" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-U1NI" name="U1NI" role="tab" tabindex="0">SSH</button><button aria-controls="panel-2-SFRUUFM=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-SFRUUFM=" name="SFRUUFM=" role="tab" tabindex="-1">HTTPS</button></div><div aria-labelledby="tab-2-U1NI" class="sphinx-tabs-panel group-tab" id="panel-2-U1NI" name="U1NI" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:USER/recipe.git
</pre></div>
</div>
<p><strong>From now on, if you are using SSH, you should pay attention and make
sure your clone URLs start with <code class="docutils literal notranslate"><span class="pre">git&#64;github.com:</span></code> now and in future
lessons.</strong></p>
</div><div aria-labelledby="tab-2-SFRUUFM=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-SFRUUFM=" name="SFRUUFM=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/USER/recipe.git
</pre></div>
</div>
<p><strong>From now on, if you are using HTTPS, you should pay attention and make
sure your clone URLs start with <code class="docutils literal notranslate"><span class="pre">https://github.com/</span></code> now and in future
lessons.</strong></p>
</div></div>
<p>This creates a directory called “recipe” unless it already exists. You can also specify the target directory
on your computer:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-U1NI" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-U1NI" name="U1NI" role="tab" tabindex="0">SSH</button><button aria-controls="panel-3-SFRUUFM=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-SFRUUFM=" name="SFRUUFM=" role="tab" tabindex="-1">HTTPS</button></div><div aria-labelledby="tab-3-U1NI" class="sphinx-tabs-panel group-tab" id="panel-3-U1NI" name="U1NI" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>git@github.com:USER/recipe.git<span class="w"> </span>myrecipe
</pre></div>
</div>
</div><div aria-labelledby="tab-3-SFRUUFM=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-SFRUUFM=" name="SFRUUFM=" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/user/recipe.git<span class="w"> </span>myrecipe
</pre></div>
</div>
</div></div>
<p>What just happened? <strong>Think of cloning as downloading the <code class="docutils literal notranslate"><span class="pre">.git</span></code> part to your
computer</strong>. After downloading the <code class="docutils literal notranslate"><span class="pre">.git</span></code> part, the default branch (the branch pointed to by HEAD) is
automatically checked out.</p>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>A repository can have one or multiple remotes (we will revisit these later).</p></li>
<li><p>Local branches often track remote branches.</p></li>
<li><p>A remote serves as a full backup of your work.</p></li>
<li><p>We’ll properly learn how to use these in the
<a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative distributed version control</a>.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-archaeology"></span><section id="inspecting-history">
<h2>Inspecting history<a class="headerlink" href="#inspecting-history" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Be able find a line of code, find out why it was introduced and when.</p></li>
<li><p>Be able to quickly find the commit that changed a behavior.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>30 min teaching/type-along</p></li>
<li><p>30 min exercise</p></li>
</ul>
</div>
<div class="admonition-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparation</p>
<p>Please make sure that you do not clone repositories inside an already tracked folder:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status
</pre></div>
</div>
<p>If you are inside an existing Git repository, step out of it.
You need to find a different location since we will clone a new repository.</p>
<p>If you see this message, this is good in this case:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>fatal:<span class="w"> </span>not<span class="w"> </span>a<span class="w"> </span>git<span class="w"> </span>repository<span class="w"> </span><span class="o">(</span>or<span class="w"> </span>any<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>parent<span class="w"> </span>directories<span class="o">)</span>:<span class="w"> </span>.git
</pre></div>
</div>
</div>
<section id="our-toolbox-for-history-inspection">
<h3>Our toolbox for history inspection<a class="headerlink" href="#our-toolbox-for-history-inspection" title="Link to this heading"></a></h3>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<p>First the instructor demonstrates few commands on a real life example
repository <a class="reference external" href="https://github.com/networkx/networkx">https://github.com/networkx/networkx</a> (mentioned in the amazing site <a class="reference external" href="https://programminghistorian.org/">The
Programming Historian</a>).
Later we will practice these in an archaeology exercise (below).</p>
</div>
<section id="warm-up-git-history-browser">
<h4>Warm-up: <a class="reference external" href="https://githistory.xyz/">“Git History” browser</a><a class="headerlink" href="#warm-up-git-history-browser" title="Link to this heading"></a></h4>
<p>As a warm-up we can try the <a class="reference external" href="https://githistory.xyz/">“Git History” browser</a>
on the README.rst file of the <a class="reference external" href="https://github.com/networkx/networkx">networkx</a> repository:</p>
<ul class="simple">
<li><p>Visit and browse <a class="reference external" href="https://github.githistory.xyz/networkx/networkx/blob/main/README.rst">https://github.githistory.xyz/networkx/networkx/blob/main/README.rst</a> (use left/right keys).</p></li>
<li><p>You can try this on some of your GitHub repositories, too!</p></li>
</ul>
</section>
<section id="searching-text-patterns-in-the-repository">
<h4>Searching text patterns in the repository<a class="headerlink" href="#searching-text-patterns-in-the-repository" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-0-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-0-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-0-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-0-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>With <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">grep</span></code> you can find all lines in a repository which contain some string or regular expression.
This is useful to find out where in the code some variable is used or some error message printed:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>TEXT
<span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;some text with spaces&quot;</span>
</pre></div>
</div>
<p>In the <a class="reference external" href="https://github.com/networkx/networkx">networkx</a> repository you can try:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/networkx/networkx
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>networkx
<span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>-i<span class="w"> </span>fixme
</pre></div>
</div>
<p>While <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">grep</span></code> searches the <strong>current state</strong> of the repository,
it is also possible to search through all changes with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">-S</span> <span class="pre">sometext</span></code>
which can be useful to find where something got removed.</p>
</div><div aria-labelledby="tab-0-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-0-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>We can try the same example in the browser:
<a class="reference external" href="https://github.com/search?q=repo%3Anetworkx%2Fnetworkx%20fixme&amp;amp;type=code">https://github.com/search?q=repo%3Anetworkx%2Fnetworkx fixme&amp;type=code</a></p>
<figure class="align-default" id="id1">
<a class="with-border reference internal image-reference" href="_images/search.png"><img alt="Searching for &quot;fixme&quot; in a GitHub repository" class="with-border" src="_images/search.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Searching for “fixme” in a GitHub repository.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</div></div>
</section>
<section id="inspecting-individual-commits">
<h4>Inspecting individual commits<a class="headerlink" href="#inspecting-individual-commits" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-1-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-1-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-1-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>We have seen this one before already. Using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> we can inspect an individual commit if
we know its hash:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>show<span class="w"> </span>HASH
</pre></div>
</div>
<p>For instance:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>show<span class="w"> </span>759d589bdfa61aff99e0535938f14f67b01c83f7
</pre></div>
</div>
</div><div aria-labelledby="tab-1-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>We can try the same example in the browser:
<a class="reference external" href="https://github.com/networkx/networkx/commit/759d589bdfa61aff99e0535938f14f67b01c83f7">https://github.com/networkx/networkx/commit/759d589bdfa61aff99e0535938f14f67b01c83f7</a></p>
<figure class="align-default" id="id2">
<a class="with-border reference internal image-reference" href="_images/show.png"><img alt="Inspecting an individual commit on GitHub" class="with-border" src="_images/show.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Inspecting an individual commit on GitHub.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
</div></div>
</section>
<section id="line-by-line-code-annotation-with-metadata">
<h4>Line-by-line code annotation with metadata<a class="headerlink" href="#line-by-line-code-annotation-with-metadata" title="Link to this heading"></a></h4>
<p>With <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annotate</span></code> you can see line by line who and <strong>when</strong> the line was
modified last. It also prints the precise hash of the last change which
modified each line. Incredibly useful for reproducibility.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-2-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-2-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-2-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>annotate<span class="w"> </span>FILE
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>annotate<span class="w"> </span>networkx/convert_matrix.py
</pre></div>
</div>
<p>If you annotate in a terminal and the file is longer than the screen, Git by default uses the program <code class="docutils literal notranslate"><span class="pre">less</span></code> to
scroll the output.
Use <code class="docutils literal notranslate"><span class="pre">/sometext</span></code> <code class="docutils literal notranslate"><span class="pre">&lt;ENTER&gt;</span></code> to find “sometext” and you can cycle through the results with <code class="docutils literal notranslate"><span class="pre">n</span></code> (next) and <code class="docutils literal notranslate"><span class="pre">N</span></code> (last).
You can also use page up/down to scroll. You can quit with <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
</div><div aria-labelledby="tab-2-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>We can try the same example in the browser:
<a class="reference external" href="https://github.com/networkx/networkx/blame/main/networkx/convert_matrix.py">https://github.com/networkx/networkx/blame/main/networkx/convert_matrix.py</a></p>
<figure class="align-default" id="id3">
<a class="with-border reference internal image-reference" href="_images/annotate.png"><img alt="Screenshot of file annotation on GitHub" class="with-border" src="_images/annotate.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Screenshot of file annotation on GitHub.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
</div></div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Discuss how these relatively trivial changes affect the annotation:</p>
<ul class="simple">
<li><p>Wrapping long lines of text/code into shorter lines</p></li>
<li><p>Auto-formatting tools such as <code class="docutils literal notranslate"><span class="pre">black</span></code></p></li>
<li><p>Editors that automatically remove trailing whitespace</p></li>
</ul>
</div>
</section>
<section id="inspecting-code-in-the-past">
<h4>Inspecting code in the past<a class="headerlink" href="#inspecting-code-in-the-past" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-Q29tbWFuZCBsaW5l" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tab" tabindex="0">Command line</button><button aria-controls="panel-3-QnJvd3NlciAoR2l0SHViKQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tab" tabindex="-1">Browser (GitHub)</button></div><div aria-labelledby="tab-3-Q29tbWFuZCBsaW5l" class="sphinx-tabs-panel group-tab" id="panel-3-Q29tbWFuZCBsaW5l" name="Q29tbWFuZCBsaW5l" role="tabpanel" tabindex="0"><p>We can create branches pointing to a commit in the past.
This is the recommended mechanism to inspect old code:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>BRANCHNAME<span class="w"> </span>HASH
</pre></div>
</div>
<p>Example (lines starting with “#” are only comments):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="c1"># create branch called &quot;older-code&quot; from hash 347e6292419b</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>older-code<span class="w"> </span>347e6292419bd0e4bff077fe971f983932d7a0e9

<span class="gp">$ </span><span class="c1"># now you can navigate and inspect the code as it was back then</span>
<span class="gp">$ </span><span class="c1"># ...</span>

<span class="gp">$ </span><span class="c1"># after we are done we can switch back to &quot;main&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main

<span class="gp">$ </span><span class="c1"># if we like we can delete the &quot;older-code&quot; branch</span>
<span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>older-code
</pre></div>
</div>
<p>On old Git versions which do not know the <code class="docutils literal notranslate"><span class="pre">switch</span></code> command (before 2.23), you
need to use this instead:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>BRANCHNAME<span class="w"> </span>SOMEHASH
</pre></div>
</div>
</div><div aria-labelledby="tab-3-QnJvd3NlciAoR2l0SHViKQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-QnJvd3NlciAoR2l0SHViKQ==" name="QnJvd3NlciAoR2l0SHViKQ==" role="tabpanel" tabindex="0"><p>We now know how to visit a specific commit:
<a class="reference external" href="https://github.com/networkx/networkx/commit/347e629">https://github.com/networkx/networkx/commit/347e629</a></p>
<p>Once we are there we can “Browse files” at that point in history.</p>
<figure class="align-default" id="id4">
<a class="with-border reference internal image-reference" href="_images/browse-files.png"><img alt="Browsing code in the past on GitHub" class="with-border" src="_images/browse-files.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Browsing code in the past on GitHub.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
</div></div>
</section>
</section>
<section id="exercise-basic-archaeology-commands">
<span id="exercise-history"></span><h3>Exercise: Basic archaeology commands<a class="headerlink" href="#exercise-basic-archaeology-commands" title="Link to this heading"></a></h3>
<div class="admonition-history-1-explore-basic-archaeology-commands exercise important admonition" id="exercise-0">
<p class="admonition-title">History-1: Explore basic archaeology commands</p>
<p>Let us explore the value of these commands in an exercise.  Future
exercises do not depend on this, so it is OK if you do not complete
it fully.</p>
<p>Exercise steps:</p>
<ul>
<li><p>Clone this repository:
<a class="reference external" href="https://github.com/networkx/networkx.git">https://github.com/networkx/networkx.git</a>.
Then step into the new directory and create an exercise branch from the networkx-2.6.3 tag/release:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/networkx/networkx.git
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>networkx
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>exercise<span class="w"> </span>networkx-2.6.3
</pre></div>
</div>
<p>On old Git versions which do not know the <code class="docutils literal notranslate"><span class="pre">switch</span></code> command (before 2.23), you
need to use this instead:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>exercise<span class="w"> </span>networkx-2.6.3
</pre></div>
</div>
</li>
</ul>
<p>Then using the above toolbox try to:</p>
<ol class="arabic simple">
<li><p>Find the code line which contains <code class="docutils literal notranslate"><span class="pre">&quot;Logic</span> <span class="pre">error</span> <span class="pre">in</span> <span class="pre">degree_correlation&quot;</span></code>.</p></li>
<li><p>Find out when this line was last modified or added. Find the actual commit which modified that line.</p></li>
<li><p>Inspect that commit with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code>.</p></li>
<li><p>Create a branch pointing to the past when that commit was created to be
able to browse and use the code as it was back then.</p></li>
<li><p>How would you bring the code to the version of the code right before that line was last modified?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>We provide here a solution for the command line but we also encourage you to
try to solve this in the browser.</p>
<ol class="arabic">
<li><p>We use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">grep</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;Logic error in degree_correlation&quot;</span>
</pre></div>
</div>
<p>This gives the output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">networkx</span><span class="o">/</span><span class="n">algorithms</span><span class="o">/</span><span class="n">threshold</span><span class="o">.</span><span class="n">py</span><span class="p">:</span>                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Logic error in degree_correlation&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">rdi</span><span class="p">)</span>
</pre></div>
</div>
<p>Maybe you also want to know the line number:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>grep<span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;Logic error in degree_correlation&quot;</span>
</pre></div>
</div>
</li>
<li><p>We use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annotate</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>annotate<span class="w"> </span>networkx/algorithms/threshold.py
</pre></div>
</div>
<p>Then search for “Logic error” by typing “/Logic error” followed by Enter.
The last commit that modified it was <code class="docutils literal notranslate"><span class="pre">90544b4fa</span></code> (unless that line changed since).</p>
</li>
<li><p>We use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>show<span class="w"> </span>90544b4fa
</pre></div>
</div>
</li>
<li><p>Create a branch pointing to that commit (here we called the branch “past-code”):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch<span class="w"> </span>past-code<span class="w"> </span>90544b4fa
</pre></div>
</div>
</li>
<li><p>This is a compact way to access the first parent of <code class="docutils literal notranslate"><span class="pre">90544b4fa</span></code> (here we
called the branch “just-before”):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>just-before<span class="w"> </span>90544b4fa~1
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</section>
<hr class="docutils" />
<section id="finding-out-when-something-broke-changed-with-git-bisect">
<h3>Finding out when something broke/changed with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code><a class="headerlink" href="#finding-out-when-something-broke-changed-with-git-bisect" title="Link to this heading"></a></h3>
<blockquote>
<div><p><em>“But I am sure it used to work! Strange.”</em></p>
</div></blockquote>
<p>Sometimes you realize that something broke.
You know that it used to work.
You do not know when it broke.</p>
<div class="admonition-how-would-you-solve-this discussion important admonition" id="discussion-1">
<p class="admonition-title">How would you solve this?</p>
<p>Before we go on first discuss how you would solve this problem: You know that it worked
500 commits ago but it does not work now.</p>
<ul class="simple">
<li><p>How would you find the commit which changed it?</p></li>
<li><p>Why could it be useful to know the commit that changed it?</p></li>
</ul>
</div>
<p>We will probably arrive at a solution which is similar to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code>:</p>
<ul>
<li><p>First find out a commit in past when it worked.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>bisect<span class="w"> </span>start
<span class="gp">$ </span>git<span class="w"> </span>bisect<span class="w"> </span>good<span class="w"> </span>f0ea950<span class="w">  </span><span class="c1"># this is a commit that worked</span>
<span class="gp">$ </span>git<span class="w"> </span>bisect<span class="w"> </span>bad<span class="w"> </span>main<span class="w">      </span><span class="c1"># last commit is broken</span>
</pre></div>
</div>
</li>
<li><p>Now compile and/or run and/or test and decide whether “good” or “bad”.</p></li>
<li><p>This is how you can tell Git that this was a working commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>bisect<span class="w"> </span>good
</pre></div>
</div>
</li>
<li><p>And this is how you can tell Git that this was not a working commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>bisect<span class="w"> </span>bad
</pre></div>
</div>
</li>
<li><p>Then bisect/iterate your way until you find the commit that broke it.</p></li>
<li><p>If you want to go back to start, type <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span> <span class="pre">reset</span></code>.</p></li>
<li><p>This can even be automatized with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span> <span class="pre">run</span> <span class="pre">SCRIPT</span></code>.
For this you write a script that returns zero/non-zero (success/failure).</p></li>
</ul>
</section>
<section id="optional-exercise-git-bisect">
<span id="exercise-bisect"></span><h3>Optional exercise: Git bisect<a class="headerlink" href="#optional-exercise-git-bisect" title="Link to this heading"></a></h3>
<div class="admonition-optional-history-2-use-git-bisect-to-find-the-bad-commit exercise important admonition" id="exercise-1">
<p class="admonition-title">(optional) History-2: Use git bisect to find the bad commit</p>
<p>In this exercise, we use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> on an example repository.  It
is OK if you do not complete this exercise fully.</p>
<p>Begin by cloning <a class="reference external" href="https://github.com/coderefinery/git-bisect-exercise">https://github.com/coderefinery/git-bisect-exercise</a>.</p>
<p><strong>Motivation</strong></p>
<p>The motivation for this exercise is to be able to do archaeology with Git on a
source code where the bug is difficult to see visually. <strong>Finding the offending
commit is often more than half the debugging</strong>.</p>
<p><strong>Background</strong></p>
<p>The script <code class="docutils literal notranslate"><span class="pre">get_pi.py</span></code> approximates pi using terms of the Nilakantha series. It
should produce 3.14 but it does not. The script broke at some point and
produces 3.57 using the last commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>get_pi.py

<span class="go">3.57</span>
</pre></div>
</div>
<p>At some point within the 500 first commits, an error was introduced. The only
thing we know is that the first commit worked correctly.</p>
<p><strong>Your task</strong></p>
<ul class="simple">
<li><p>Clone this repository and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> to find the commit which
broke the computation
(<a class="reference external" href="https://github.com/coderefinery/git-bisect-exercise#solutions-spoiler-alert">solution - spoiler alert!</a>).</p></li>
<li><p>Once you have found the offending commit, also practice navigating to the last good commit.</p></li>
<li><p>Bonus exercise:
Write a script that checks for a correct result and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span> <span class="pre">run</span></code> to
find the offending commit automatically
(<a class="reference external" href="https://github.com/coderefinery/git-bisect-exercise#solutions-spoiler-alert">solution - spoiler alert!</a>).</p></li>
</ul>
<p><strong>Hints</strong></p>
<p>Finding the first commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>How to navigate to the parent of a commit with hash SOMEHASH:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>BRANCHNAME<span class="w"> </span>SOMEHASH~1
</pre></div>
</div>
<p>Instead of a tilde you can also use this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>BRANCHNAME<span class="w"> </span>SOMEHASH^
</pre></div>
</div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>git log/grep/annotate/show/bisect is a powerful combination when doing archaeology in a project.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span> <span class="pre">--create</span> <span class="pre">NAME</span> <span class="pre">HASH</span></code> is the recommended mechanism to inspect old code.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-level"></span><section id="practical-advice-how-much-git-is-necessary">
<h2>Practical advice: how much Git is necessary?<a class="headerlink" href="#practical-advice-how-much-git-is-necessary" title="Link to this heading"></a></h2>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>20 min teaching/discussion</p></li>
</ul>
</div>
<section id="what-level-of-branching-complexity-is-necessary-for-each-project">
<h3>What level of branching complexity is necessary for each project?<a class="headerlink" href="#what-level-of-branching-complexity-is-necessary-for-each-project" title="Link to this heading"></a></h3>
<section id="simple-personal-projects">
<h4>Simple personal projects<a class="headerlink" href="#simple-personal-projects" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Typically start with just the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch.</p></li>
<li><p>Use branches for unfinished/untested ideas.</p></li>
<li><p>Use branches when you are not sure about a change.</p></li>
<li><p>Use tags to mark important milestones.</p></li>
</ul>
</section>
<section id="projects-with-few-persons-you-accept-things-breaking-sometimes">
<h4>Projects with few persons: you accept things breaking sometimes<a class="headerlink" href="#projects-with-few-persons-you-accept-things-breaking-sometimes" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>It might be reasonable to commit to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and feature branches.</p></li>
</ul>
</section>
<section id="projects-with-few-persons-changes-are-reviewed-by-others">
<h4>Projects with few persons: changes are reviewed by others<a class="headerlink" href="#projects-with-few-persons-changes-are-reviewed-by-others" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>You create new feature branches for changes.</p></li>
<li><p>Changes are reviewed before they are merged to the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch
(more about that in the <a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative Git lesson</a>).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> branch is write-protected and can only be changed with pull requests or merge requests.</p></li>
</ul>
</section>
<section id="when-you-distribute-releases">
<h4>When you distribute releases<a class="headerlink" href="#when-you-distribute-releases" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>If you want to patch releases, you probably need release branches.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and release branches are read-only.</p></li>
<li><p>Many <a class="reference external" href="https://coderefinery.github.io/git-branch-design/05-branching-models/">branching models</a> exist.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="how-about-staging-and-committing">
<h3>How about staging and committing?<a class="headerlink" href="#how-about-staging-and-committing" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>It is OK to start committing directly by doing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">SOMEFILE</span></code>.</p></li>
<li><p>Commit early and often: rather create too many commits than too few.
You can always combine commits later.</p></li>
<li><p>Once you commit, it is very, very hard to really lose your code.</p></li>
<li><p>Always fully commit (or stash) before you do dangerous things, so that you know you are safe.
Otherwise it can be hard to recover.</p></li>
<li><p>Later you can start using the staging area.</p></li>
<li><p>Later start using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">-p</span></code> and/or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-p</span></code>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="how-large-should-a-commit-be">
<h3>How large should a commit be?<a class="headerlink" href="#how-large-should-a-commit-be" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Better too small than too large (easier to combine than to split).</p></li>
<li><p>Often I make a commit at the end of the day (this is a unit I would not like to lose).</p></li>
<li><p>Smaller sized commits may be easier to review for others than huge commits.</p></li>
<li><p>Imperfect commits are better than no commits.</p></li>
<li><p>A commit should not contain unrelated changes to simplify review and possible
repair/adjustments/undo later (but again: imperfect commits are better than no commits).</p></li>
</ul>
<hr class="docutils" />
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>There is no one size fits all - start simple and grow your project.</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>How do you [plan to] use Git?</p>
<ul class="simple">
<li><p>Advanced users or beginners, please provide your input in the online collaborative document.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-what-to-avoid"></span><section id="what-to-avoid">
<h2>What to avoid<a class="headerlink" href="#what-to-avoid" title="Link to this heading"></a></h2>
<p>The idea for this page came up during a discussion: quick reference page of
things that you should not do with Git. Basically, a list of some common Git
gotchas.</p>
<p><strong>Postponing commits because the changes are “unfinished”/”ugly”</strong>: It is
better to have many OK-ish commits than too few perfect commits.  Too few
perfect commits are probably too large and make undoing more difficult.  It is
also easier to combine too small commits than it is to split too large commits.
The longer you wait because of this, the harder it will be to
commit it at all.</p>
<p><strong>Not updating your branch before starting new work</strong>: Few things are worse
than doing work and then noticing a lot of conflicts because
unrelated but conflicting work was done in the meantime or even before you started.  Or noticing that someone
else has already done it.  This problem is largest when you come back
to an active project weeks or months later.</p>
<p><strong>Commit unrelated changes together</strong>: Makes it difficult to undo changes since
it can undo also the unrelated change.
But, this is the counterpoint to the first point: In the end, it is probably better to make big
ugly commits than to never commit.  This is especially true in in the chaotic early
phases of small projects.</p>
<p><strong>Too ambitious branch which risks to never get completed</strong>: The branch will
never merge back and be so big and so ambitious with too many/big features that
the risk is high that once it is really ready, there are conflicts everywhere.</p>
<p><strong>Committing generated files</strong>: See <a class="reference internal" href="index.html#gitignore"><span class="std std-ref">Ignoring files and paths with .gitignore</span></a>.</p>
<p><strong>Over-engineering the branch layout and safeguards in small projects</strong>: This
may prevent people from contributing (maybe even including yourself?). Add more restrictions and safeguards as
the project and the group of collaborators grows.</p>
<p><strong>Commit messages that explain what has been changed but do not explain why it has been
changed</strong>: This is as useful as code comments which describe the “obvious” such
as “this is a loop” instead of explaining why something is done this way.
But don’t let perfect commit messages stop you from the most important point, committing often (first point).</p>
<p><strong>Commit huge files</strong>: Huge files get sometimes accidentally added and
committed which can significantly increase the repository size. Note that a
subsequent <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span></code> does not remove the addition from the repository history.
Code review can help detecting accidental large file additions.
You can also add an automated test which checks for file sizes during a pull request or merge request.</p>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Question to all seasoned Git users: What are we missing on this page? Please
contribute improvements.</p>
</div>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-staging-area"></span><section id="using-the-git-staging-area">
<h2>Using the Git staging area<a class="headerlink" href="#using-the-git-staging-area" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn how to tell a story with your commit history.</p></li>
<li><p>Demystify the Git staging area.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>10 min teaching/type-along</p></li>
<li><p>10 min exercise</p></li>
</ul>
</div>
<section id="commit-history-is-telling-a-story">
<h3>Commit history is telling a story<a class="headerlink" href="#commit-history-is-telling-a-story" title="Link to this heading"></a></h3>
<p>Your <em>current code</em> is very important, but the <em>history</em> can be just
as important - it tells a story about how your code came to be.</p>
<ul class="simple">
<li><p>Each individual line of code rarely stands alone.</p></li>
<li><p>You often want to see all the related changes together.</p></li>
<li><p>But you also hardly ever do one thing at once.</p></li>
</ul>
<p>Along with your code, Git creates a <em>history</em> for you, and if your
history is clear then you are a long way to organized code.</p>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Here are five types of history.  What are the advantages and
disadvantages of each, when you look at it later?</p>
<p><strong>Example 1</strong>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>b135ec8<span class="w"> </span>add<span class="w"> </span>features<span class="w"> </span>A,<span class="w"> </span>B,<span class="w"> </span>and<span class="w"> </span>C
</pre></div>
</div>
<p><strong>Example 2</strong> (newest commit is on top):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>6f0d49f<span class="w"> </span>implement<span class="w"> </span>feature<span class="w"> </span>C
fee1807<span class="w"> </span>implement<span class="w"> </span>feature<span class="w"> </span>B
6fe2f23<span class="w"> </span>implement<span class="w"> </span>feature<span class="w"> </span>A
</pre></div>
</div>
<p><strong>Example 3</strong>:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>ab990f4<span class="w"> </span>saving<span class="w"> </span>three<span class="w"> </span>months<span class="w"> </span>of<span class="w"> </span>miscellaneous<span class="w"> </span>work<span class="w"> </span>I<span class="w"> </span>forgot<span class="w"> </span>to<span class="w"> </span>commit
</pre></div>
</div>
<p><strong>Example 4</strong> (newest commit is on top):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>bf39f9d<span class="w"> </span>more<span class="w"> </span>work<span class="w"> </span>on<span class="w"> </span>feature<span class="w"> </span>B
45831a5<span class="w"> </span>removing<span class="w"> </span>debug<span class="w"> </span>prints<span class="w"> </span><span class="k">for</span><span class="w"> </span>feature<span class="w"> </span>A<span class="w"> </span>and<span class="w"> </span>add<span class="w"> </span>new<span class="w"> </span>file
bddb280<span class="w"> </span>more<span class="w"> </span>work<span class="w"> </span>on<span class="w"> </span>feature<span class="w"> </span>B<span class="w"> </span>and<span class="w"> </span>make<span class="w"> </span>feature<span class="w"> </span>A<span class="w"> </span>compile<span class="w"> </span>again
72d78e7<span class="w"> </span>feature<span class="w"> </span>A<span class="w"> </span>did<span class="w"> </span>not<span class="w"> </span>work<span class="w"> </span>and<span class="w"> </span>started<span class="w"> </span>work<span class="w"> </span>on<span class="w"> </span>feature<span class="w"> </span>B
b135ec8<span class="w"> </span>now<span class="w"> </span>feature<span class="w"> </span>A<span class="w"> </span>should<span class="w"> </span>work
72e0211<span class="w"> </span>another<span class="w"> </span>fix<span class="w"> </span>to<span class="w"> </span>make<span class="w"> </span>it<span class="w"> </span>compile
61dd3a3<span class="w"> </span>forgot<span class="w"> </span>file<span class="w"> </span>and<span class="w"> </span>bugfix
49dc419<span class="w"> </span>wip<span class="w"> </span><span class="o">(</span>work<span class="w"> </span><span class="k">in</span><span class="w"> </span>progress<span class="o">)</span>
</pre></div>
</div>
<p><strong>Example 5</strong> (newest commit is on top):</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>1949dc4<span class="w"> </span>Work<span class="w"> </span>of<span class="w"> </span><span class="m">2020</span>-04-07
a361dd3<span class="w"> </span>Work<span class="w"> </span>of<span class="w"> </span><span class="m">2020</span>-04-06
1172e02<span class="w"> </span>Work<span class="w"> </span>of<span class="w"> </span><span class="m">2020</span>-04-03
e772d78<span class="w"> </span>Work<span class="w"> </span>of<span class="w"> </span><span class="m">2020</span>-04-02
</pre></div>
</div>
<p>Discuss these examples. Can you anticipate problems?</p>
</div>
<p>We want to have nice commits.  But we also want to “save often”
(checkpointing) - how can we have both?</p>
<ul class="simple">
<li><p>We will now learn to create nice commits using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--patch</span></code> and/or the staging area.</p></li>
<li><p>Staging addresses the issue of having unrelated changes in the same
commit or having one logical change spread over several commits.</p></li>
<li><p>The staging area isn’t the only way to organize your history nicely, some alternatives are discussed at the end of the lesson.</p></li>
</ul>
</section>
<section id="interactive-commits">
<h3>Interactive commits<a class="headerlink" href="#interactive-commits" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The simplest ways to solve this is to do <strong>interactive commits</strong>:
the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--patch</span></code> option (or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-p</span></code> for short).</p></li>
<li><p>It will present you with every change you have made individually,
and you can decide which ones to commit right now.</p></li>
<li><p>Reference and key commands</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--patch</span></code> to start the interactive commit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> to use the change</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> to skip the change</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> (split) if there are several changes grouped together, but
separated by a blank line, split them into separate choices.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">q</span></code> aborts everything.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">?</span></code> for more options.</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">-p</span></code> option is also available on <code class="docutils literal notranslate"><span class="pre">commit</span></code>, <code class="docutils literal notranslate"><span class="pre">restore</span></code>, <code class="docutils literal notranslate"><span class="pre">checkout</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code>, and <code class="docutils literal notranslate"><span class="pre">add</span></code>.</p></li>
</ul>
</section>
<section id="exercise-interactive-commits">
<span id="id1"></span><h3>Exercise: Interactive commits<a class="headerlink" href="#exercise-interactive-commits" title="Link to this heading"></a></h3>
<div class="admonition-staging-1-perform-an-interactive-commit exercise important admonition" id="exercise-0">
<p class="admonition-title">Staging-1: Perform an interactive commit</p>
<p>One option to help us create nice logical commits is to stage <em>interactively</em>
with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--patch</span></code>:</p>
<ol class="arabic simple">
<li><p>Make two changes in <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code>, at the top and bottom
of the file.
<strong>Make sure that they are separated by at least several unmodified lines.</strong></p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--patch</span></code>.  Using the keystrokes above, commit one of
the changes.</p></li>
<li><p>Do it again for the other change.</p></li>
<li><p>When you’re done, inspect the situation with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--staged</span></code>.</p></li>
<li><p>When would this be useful?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>This can be useful if you have several modification in a file (or several
files) but you decide that it would be beneficial to save them as two (or
more) separate commits.</p>
</div>
</div>
</section>
<section id="the-staging-area">
<h3>The staging area<a class="headerlink" href="#the-staging-area" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>The interactive commits above are great, but what if there are so
many changes that you can’t sort them out in one shot?</p></li>
<li><p>What if you make progress and want to record it somehow, but it’s
not ready to be committed?</p></li>
<li><p>The <strong>staging area</strong> is a place to record things before committing.</p></li>
</ul>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-1">
<p class="admonition-title">Instructor note</p>
<p>We give two examples and the instructor can pick one or both:</p>
<ul class="simple">
<li><p>Analogy using moving boxes</p></li>
<li><p>Analogy using shopping receipts</p></li>
</ul>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-1">
<p class="admonition-title">Discussion</p>
<p><strong>Analogy using moving boxes</strong></p>
<ul class="simple">
<li><p>You’re moving and you have a box to pack your things in.</p></li>
<li><p>You can put stuff into the box, but you can also take stuff out of the box.</p></li>
<li><p>You wouldn’t want to mix items from the bathroom, kitchen, and living room
into the same box.</p></li>
<li><p>The box corresponds to the staging area of Git, where you can craft your commits.</p></li>
<li><p>Committing is like sealing the box and sticking a label on it.</p></li>
<li><p>You wouldn’t want to label your box with “stuff”, but rather give a more
descriptive label.</p></li>
<li><p>See also <a class="reference external" href="https://dev.to/sublimegeek/git-staging-area-explained-like-im-five-1anh">https://dev.to/sublimegeek/git-staging-area-explained-like-im-five-1anh</a></p></li>
</ul>
<p><strong>Analogy using shopping receipts</strong></p>
<ul class="simple">
<li><p>You need to go shopping and buy some stuff for work and for home.
You need two separate receipts.</p></li>
<li><p>Bad idea: go through the store get home stuff, pay, start at the
beginning and go through the store again.  This is inefficient and
annoying.</p></li>
<li><p>What you actually do:</p>
<ul>
<li><p>Go through the store and put everything you need in your shopping
basket.</p></li>
<li><p>Get to the check-out.  Put your home stuff on the conveyor belt
(<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>).  Check both the belt (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--staged</span></code>) and your
basket (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>) to make sure you got all your home stuff.</p></li>
<li><p>Pay (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>)</p></li>
<li><p>Repeat for work stuff.</p></li>
</ul>
</li>
</ul>
<p>In order to keep organized, you have to use multiple locations to
stage things in sequence.</p>
</div>
</section>
<section id="staging-area-commands">
<h3>Staging area commands<a class="headerlink" href="#staging-area-commands" title="Link to this heading"></a></h3>
<p>The staging area is a middle ground between what you have done to your files
(the <strong>working directory</strong>) and what you have last committed (the <strong>HEAD commit</strong>).
Just like the name implies, it lets you prepare (<strong>stage</strong>) what the next commit will be and most importantly give you tools to easily know what is going on.
This adds some complexity but also adds more flexibility to selectively
prepare commits since <strong>you can modify and stage several times before committing</strong>.</p>
<p><strong>git add</strong> stages/prepares for the next commit:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                git add
 [project*]  &lt;------------  project*
                               ^
                               | modify with editor
                               |
  HEAD            .         project
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<p><strong>git commit</strong> creates a new commit:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>  HEAD            .         project
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
  HEAD~2          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<p><strong>git reset --soft HEAD~1</strong> (move HEAD back by one but keep changes and stage
them) would do the opposite of <strong>git commit</strong>.  (in this case, <code class="docutils literal notranslate"><span class="pre">HEAD</span></code>
is literally this - not a replacement)</p>
<p>Going back to the last staged version:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>              git restore
 [project*]  ------------&gt;  project*



  HEAD            .
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<p>Unstaging changes with <strong>git restore --staged</strong>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>          git restore --staged
             ------------&gt;  project*



  HEAD            .
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<p>Discarding unstaged changes:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                            project*
                               |
                               | git restore
                               v
  HEAD            .         project
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<p>Comparing:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                git diff
 [project*]  &lt;-----------&gt;  project*
    ^                          ^
    | git diff --staged        | git diff HEAD
    v                          v
  HEAD            .
    |             .
    |             .
    |             .
  HEAD~1          .
    |             .
    |             .
    |             .
                  .
  .git            .     working directory
(history)         .      (files we see)
</pre></div>
</div>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/staging-basics.svg"><img alt="Staging basics" src="_images/staging-basics.svg" width="100%" /></a>
<figcaption>
<p><span class="caption-text">The different states of the repository and the commands to move from one to
another.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="exercise-using-the-staging-area">
<span id="exercise-staging-area"></span><h3>Exercise: Using the staging area<a class="headerlink" href="#exercise-using-the-staging-area" title="Link to this heading"></a></h3>
<div class="admonition-staging-2-use-the-staging-area-to-make-a-commit-in-two-steps exercise important admonition" id="exercise-1">
<p class="admonition-title">Staging-2: Use the staging area to make a commit in two steps</p>
<ol class="arabic simple">
<li><p>In your recipe example, make two different changes to
<code class="docutils literal notranslate"><span class="pre">ingredients.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">instructions.txt</span></code> which do not go together.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> to stage one of the changes.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> to see what’s going on, and use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--staged</span></code> to see the changes.</p></li>
<li><p>Feel some regret and unstage the staged change.</p></li>
</ol>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-2">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>When is it better to “save” a change as commit, when is it better to “save”
it with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>?</p></li>
<li><p>Is it a problem to commit many small changes?</p></li>
</ul>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>The staging area helps us to create well-defined commits.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-recovering"></span><section id="undoing-and-recovering">
<h2>Undoing and recovering<a class="headerlink" href="#undoing-and-recovering" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn to undo changes safely</p></li>
<li><p>See when undone changes are permanently deleted and when they can be retrieved</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>25 min teaching/type-along</p></li>
<li><p>25 min exercise</p></li>
</ul>
</div>
<p>One of the main points of version control is that you can <em>go back in
time to recover</em>.  Unlike this xkcd comic implies: <a class="reference external" href="https://xkcd.com/1597/">https://xkcd.com/1597/</a></p>
<p>In this episode we show a couple of commands that can be used to undo mistakes.
We also list a couple of common mistakes and discuss how to recover from them.
Some commands preserve the commit history and some modify commit history.
Modifying history? Isn’t a “commit” permanent?</p>
<ul class="simple">
<li><p>You can modify old commit history.</p></li>
<li><p>But if you have shared that history already, <em>modifying it can make
a huge mess</em>.</p></li>
</ul>
<div class="admonition-it-is-almost-always-possible-to-recover admonition">
<p class="admonition-title">It is almost always possible to recover</p>
<p>As long as you commit something once (or at least <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> it), you
can almost always go back to it, no matter what you do.
But you may need to ask Stack Overflow or your local
guru… <em>until that guru becomes you</em>.</p>
</div>
<div class="admonition-nice-resource-to-visually-simulate-git-operation admonition">
<p class="admonition-title">Nice resource to visually simulate Git operation</p>
<p><a class="reference external" href="https://github.com/initialcommit-com/git-sim#video-animation-examples">git-sim</a>
is a nice resouce to visually simulate Git operations listed in this episode
below, in your own repos with a single terminal command.</p>
</div>
<hr class="docutils" />
<section id="undoing-your-recent-uncommitted-and-unstaged-changes-preserves-history">
<h3>Undoing your recent, uncommitted and unstaged changes (preserves history)<a class="headerlink" href="#undoing-your-recent-uncommitted-and-unstaged-changes-preserves-history" title="Link to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span></code> does not work, your Git version might be older than from 2019.
On older Git it is <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span></code>.</p>
</div>
<p>You do some work, and want to <strong>undo your uncommitted and unstaged modifications</strong>.
You can always do that with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">.</span></code> (the dot means “here and in all folders below”)</p></li>
</ul>
<p>You can also undo things selectively:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">-p</span></code> (decide which portions of changes to undo) or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">PATH</span></code> (decide which path/file)</p></li>
</ul>
<p>If you have staged changes, you have at least two options to undo the staging:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">--staged</span> <span class="pre">.</span></code> followed by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HEAD</span></code> throws away everything that is not in last
commit (<code class="docutils literal notranslate"><span class="pre">HEAD</span></code> - this literal word, this isn’t a placeholder)</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="reverting-commits-preserves-history">
<h3>Reverting commits (preserves history)<a class="headerlink" href="#reverting-commits-preserves-history" title="Link to this heading"></a></h3>
<p>Imagine we made a few commits.
We realize that the latest commit <code class="docutils literal notranslate"><span class="pre">e02efcd</span></code> was a mistake and we wish to undo it:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline

<span class="go">e02efcd (HEAD -&gt; main) not sure this is a good idea</span>
<span class="go">b4af65b improve the documentation</span>
<span class="go">e7cf023 don&#39;t forget to enjoy</span>
<span class="go">79161b6 add half an onion</span>
<span class="go">a3394e3 adding README</span>
<span class="go">3696246 adding instructions</span>
<span class="go">f146d25 adding ingredients</span>
</pre></div>
</div>
<p>A safe way to undo the commit is to revert the commit with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>revert<span class="w"> </span>e02efcd
</pre></div>
</div>
<p>This creates a <strong>new commit</strong> that does the opposite of the reverted commit.
The old commit remains in the history:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline

<span class="go">d3fc63a (HEAD -&gt; main) Revert &quot;not sure this is a good idea&quot;</span>
<span class="go">e02efcd not sure this is a good idea</span>
<span class="go">b4af65b improve the documentation</span>
<span class="go">e7cf023 don&#39;t forget to enjoy</span>
<span class="go">79161b6 add half an onion</span>
<span class="go">a3394e3 adding README</span>
<span class="go">3696246 adding instructions</span>
<span class="go">f146d25 adding ingredients</span>
</pre></div>
</div>
<p>You can revert any commit, no matter how old it is.  It doesn’t affect
other commits you have done since then - but if they touch the same
code, you may get a conflict (which we’ll learn about later).</p>
<section id="exercise-revert-a-commit">
<span id="exercise-revert"></span><h4>Exercise: Revert a commit<a class="headerlink" href="#exercise-revert-a-commit" title="Link to this heading"></a></h4>
<div class="admonition-undoing-1-revert-a-commit exercise important admonition" id="exercise-0">
<p class="admonition-title">Undoing-1: Revert a commit</p>
<ul class="simple">
<li><p>Create a commit (commit A).</p></li>
<li><p>Revert the commit with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> (commit B).</p></li>
<li><p>Inspect the history with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--oneline</span></code>.</p></li>
<li><p>Now try <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> on both the reverted (commit A) and the newly created commit (commit B).</p></li>
</ul>
</div>
</section>
</section>
<section id="adding-to-the-previous-commit-modifies-history">
<h3>Adding to the previous commit (modifies history)<a class="headerlink" href="#adding-to-the-previous-commit-modifies-history" title="Link to this heading"></a></h3>
<p>Sometimes we commit but realize we forgot something.
We can amend to the last commit:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>commit<span class="w"> </span>--amend
</pre></div>
</div>
<p>This can also be used to modify the last commit message.</p>
<p>Note that this <strong>will change the commit hash</strong>. This command <strong>modifies the history</strong>.
This means that we avoid this command on commits that we have shared with others.</p>
<section id="exercise-modify-a-previous-commit">
<span id="exercise-amend"></span><h4>Exercise: Modify a previous commit<a class="headerlink" href="#exercise-modify-a-previous-commit" title="Link to this heading"></a></h4>
<div class="admonition-undoing-2-modify-a-previous-commit exercise important admonition" id="exercise-1">
<p class="admonition-title">Undoing-2: Modify a previous commit</p>
<ol class="arabic simple">
<li><p>Make an incomplete change to the recipe or a typo in your change, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code> the incomplete/unsatisfactory change.</p></li>
<li><p>Inspect the unsatisfactory but committed change with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code>. Remember
or write down the commit hash.</p></li>
<li><p>Now complete/fix the change but instead of creating a new commit, add the
correction to the previous commit with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code>.  What changed?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>One thing that has changed now is the commit hash. Modifying the previous
commit has changed the history. This is OK to do on commits that other people
don’t depend on yet.</p>
</div>
</div>
</section>
</section>
<section id="rewinding-branches-modifies-history">
<h3>Rewinding branches (modifies history)<a class="headerlink" href="#rewinding-branches-modifies-history" title="Link to this heading"></a></h3>
<p>You can <strong>reset branch history</strong> to move your branch back to some
point in the past.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HASH</span></code> will force a branch label to any other point.  All
other changes are lost (but it is possible to recover if you force reset by mistake).</p></li>
<li><p>Be careful if you do this - it can mess stuff up.  Use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> a
lot before and after.</p></li>
</ul>
<section id="exercise-git-reset">
<span id="exercise-reset"></span><h4>Exercise: Git reset<a class="headerlink" href="#exercise-git-reset" title="Link to this heading"></a></h4>
<div class="admonition-undoing-3-destroy-our-experimentation-in-this-episode exercise important admonition" id="exercise-2">
<p class="admonition-title">Undoing-3: Destroy our experimentation in this episode</p>
<p>After we have experimented with reverts and amending, let us destroy
all of that and get our repositories to a similar state.</p>
<ul class="simple">
<li><p>First, we will look at our history (<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>/<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>) and
find the last commit <code class="docutils literal notranslate"><span class="pre">HASH</span></code> before our tests.</p></li>
<li><p>Then, we will <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HASH</span></code> to that.</p></li>
<li><p>Then, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> again to see what happened.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline

<span class="go">d3fc63a (HEAD -&gt; main) Revert &quot;not sure this is a good idea&quot;</span>
<span class="go">e02efcd not sure this is a good idea</span>
<span class="go">b4af65b improve the documentation</span>
<span class="go">e7cf023 don&#39;t forget to enjoy</span>
<span class="go">79161b6 add half an onion</span>
<span class="go">a3394e3 adding README</span>
<span class="go">3696246 adding instructions</span>
<span class="go">f146d25 adding ingredients</span>

<span class="gp">$ </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>b4af65b

<span class="go">HEAD is now at b4af65b improve the documentation</span>

<span class="gp">$ </span>git<span class="w"> </span>log<span class="w"> </span>--oneline

<span class="go">b4af65b (HEAD -&gt; main) improve the documentation</span>
<span class="go">e7cf023 don&#39;t forget to enjoy</span>
<span class="go">79161b6 add half an onion</span>
<span class="go">a3394e3 adding README</span>
<span class="go">3696246 adding instructions</span>
<span class="go">f146d25 adding ingredients</span>
</pre></div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="recovering-from-committing-to-the-wrong-branch">
<h3>Recovering from committing to the wrong branch<a class="headerlink" href="#recovering-from-committing-to-the-wrong-branch" title="Link to this heading"></a></h3>
<p>It is easy to forget to create a branch or to create it and forget to switch to
it when committing changes.</p>
<p>Here we assume that we made a couple of commits but we realize they went to the
wrong branch.</p>
<p><strong>Solution 1 using git cherry-pick</strong>:</p>
<ol class="arabic simple">
<li><p>Make sure that the correct branch exists and if not, create it. Make sure to
create it from the commit hash where you wish you had created it from: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">BRANCHNAME</span> <span class="pre">HASH</span></code></p></li>
<li><p>Switch to the correct branch.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">HASH</span></code> can be used to take a specific commit to the
current branch. Cherry-pick all commits that should have gone to the correct
branch, <strong>from oldest to most recent</strong>.</p></li>
<li><p>Rewind the branch that accidentally got wrong commits with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span></code> (see also above).</p></li>
</ol>
<p><strong>Solution 2 using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span></code></strong> (makes sense if the correct branch should
contain all commits of the accidentally modified branch):</p>
<ol class="arabic simple">
<li><p>Create the correct branch, pointing at the latest commit: <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">BRANCHNAME</span></code>.</p></li>
<li><p>Check with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> or <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> that both branches point to the same, latest, commit.</p></li>
<li><p>Rewind the branch that accidentally got wrong commits with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span></code> (see also above).</p></li>
</ol>
</section>
<section id="recovering-from-merging-pulling-into-the-wrong-branch">
<h3>Recovering from merging/pulling into the wrong branch<a class="headerlink" href="#recovering-from-merging-pulling-into-the-wrong-branch" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code>, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code>, and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> modify the <strong>current</strong> branch, never
the other branch. But sometimes we run this command on the wrong branch.</p>
<ol class="arabic simple">
<li><p>Check with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> the commit hash that you would like to rewind the
wrongly modified branch to.</p></li>
<li><p>Rewind the branch that accidentally got wrong commits with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HASH</span></code> (see also above).</p></li>
</ol>
</section>
<section id="recovering-from-conflict-after-pulling-changes">
<h3>Recovering from conflict after pulling changes<a class="headerlink" href="#recovering-from-conflict-after-pulling-changes" title="Link to this heading"></a></h3>
<p>Pulling changes with
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> can create a conflict since <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> always also includes a <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code> (more about this
in the <a class="reference external" href="https://coderefinery.github.io/git-collaborative/">collaborative Git lesson</a>).</p>
<p>The recovery is same as described in <a class="reference internal" href="index.html#conflict-resolution"><span class="std std-ref">Conflict resolution</span></a>. Either
resolve conflicts or abort the merge with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">--abort</span></code>.</p>
<hr class="docutils" />
<div class="admonition-undoing-4-test-your-understanding exercise important admonition" id="exercise-3">
<p class="admonition-title">Undoing-4: Test your understanding</p>
<ol class="arabic simple">
<li><p>What happens if you accidentally remove a tracked file with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span></code>, is it gone forever?</p></li>
<li><p>Is it OK to modify commits that nobody has seen yet?</p></li>
<li><p>What situations would justify to modify the Git history and possibly remove commits?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<ol class="arabic simple">
<li><p>It is not gone forever since <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span></code> creates a new commit. You can revert the commit to get the file back.</p></li>
<li><p>If you haven’t shared your commits with anyone it can be alright to modify them.</p></li>
<li><p>If you have shared your commits with others (e.g. pushed them to GitHub), only extraordinary
conditions would justify modifying history. For example to remove sensitive or secret information.</p></li>
</ol>
</div>
</div>
</section>
</section>
<span id="document-interrupted"></span><section id="interrupted-work">
<h2>Interrupted work<a class="headerlink" href="#interrupted-work" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn to switch context or abort work without panicking.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>10 min teaching/type-along</p></li>
<li><p>15 min exercise</p></li>
</ul>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>There is almost never reason to clone a fresh copy to complete a task that
you have in mind.</p></li>
</ul>
</div>
<section id="frequent-situation-interrupted-work">
<h3>Frequent situation: interrupted work<a class="headerlink" href="#frequent-situation-interrupted-work" title="Link to this heading"></a></h3>
<p>We all wish that we could write beautiful perfect code. But the real world is
much more chaotic:</p>
<ul class="simple">
<li><p>You are in the middle of a “Jackson-Pollock-style” debugging spree with 27 modified files
and debugging prints everywhere.</p></li>
<li><p>Your colleague comes in and wants you to fix/commit something right now.</p></li>
<li><p>What to do?</p></li>
</ul>
<p>Git provides lots of ways to switch tasks without ruining everything.</p>
</section>
<section id="option-1-stashing">
<h3>Option 1: Stashing<a class="headerlink" href="#option-1-stashing" title="Link to this heading"></a></h3>
<p>The <strong>stash</strong> is the first and easiest place to temporarily “stash”
things.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code> will put working directory and staging area changes
away.  Your code will be same as last commit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span></code> will return to the state you were before. Can give it a list.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">list</span></code> will list the current stashes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">save</span> <span class="pre">NAME</span></code> is like the first, but will give it a name.
Useful if it might last a while.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">save</span> <span class="pre">[-p]</span> <span class="pre">[filename]</span></code> will stash certain files files
and/or by patches.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">drop</span></code> will drop the most recent stash (or whichever stash
you give).</p></li>
<li><p>The stashes form a stack, so you can stash several batches of modifications.</p></li>
</ul>
<section id="exercise-stashing">
<span id="id1"></span><h4>Exercise: Stashing<a class="headerlink" href="#exercise-stashing" title="Link to this heading"></a></h4>
<div class="admonition-interrupted-1-stash-some-uncommitted-work exercise important admonition" id="exercise-0">
<p class="admonition-title">Interrupted-1: Stash some uncommitted work</p>
<ol class="arabic simple">
<li><p>Make a change.</p></li>
<li><p>Check status/diff, stash the change with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>, check status/diff again.</p></li>
<li><p>Make a separate, unrelated change which doesn’t touch the same
lines.  Commit this change.</p></li>
<li><p>Pop off the stash you saved with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span></code>, and check status/diff.</p></li>
<li><p>Optional: Do the same but stash twice.  Also check <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">list</span></code>.
Can you pop the stashes in the opposite order?</p></li>
<li><p>Advanced: What happens if stashes conflict with other changes? Make
a change and stash it.  Modify the same line or one right above or
below.  Pop the stash back.  Resolve the conflict.  Note there is no
extra commit.</p></li>
<li><p>Advanced: what does <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> show when you have something
stashed?</p></li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<p>5: Yes you can. With <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span> <span class="pre">INDEX</span></code> you can decie which stash
index to pop.</p>
<p>6: In this case Git will ask us to resolve the conflict the same way
when resolving conflicts between two branches.</p>
<p>7: It shows an additional commit hash with <code class="docutils literal notranslate"><span class="pre">refs/stash</span></code>.</p>
</div>
</div>
</section>
</section>
<section id="option-2-create-branches">
<h3>Option 2: Create branches<a class="headerlink" href="#option-2-create-branches" title="Link to this heading"></a></h3>
<p>You can use branches almost like you have already been doing if you
need to save some work.  You need to do something else for a bit?
Sounds like a good time to make a feature branch.</p>
<p>You basically know how to do this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>temporary<span class="w">  </span><span class="c1"># create a branch and switch to it</span>
<span class="gp">$ </span>git<span class="w"> </span>add<span class="w"> </span>PATHS<span class="w">                  </span><span class="c1"># stage changes</span>
<span class="gp">$ </span>git<span class="w"> </span>commit<span class="w">                     </span><span class="c1"># commit them</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>main<span class="w">                </span><span class="c1"># back to main, continue your work there ...</span>
<span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>temporary<span class="w">           </span><span class="c1"># continue again on &quot;temporary&quot; where you left off</span>
</pre></div>
</div>
<p>Later you can merge it to main or rebase it on top of main and resume work.</p>
</section>
<section id="storing-various-junk-you-don-t-need-but-don-t-want-to-get-rid-of">
<h3>Storing various junk you don’t need but don’t want to get rid of<a class="headerlink" href="#storing-various-junk-you-don-t-need-but-don-t-want-to-get-rid-of" title="Link to this heading"></a></h3>
<p>It happens often that you do something and don’t need it, but you don’t want to
lose it right away.  You can use either of the above strategies to stash/branch
it away: using branches is probably better because branches are less easily
overlooked if you come back to the repository in few weeks.  Note that if you
try to use a branch after a long time, conflicts might get really bad but at
least you have the data still.</p>
</section>
</section>
<span id="document-aliases"></span><section id="aliases-and-configuration">
<h2>Aliases and configuration<a class="headerlink" href="#aliases-and-configuration" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Learn to use aliases for most common commands.</p></li>
</ul>
</div>
<p>Are you getting tired of typing so much? In Git you can define aliases (shortcuts):</p>
<ul class="simple">
<li><p>These are great because they can save you time typing.</p></li>
<li><p>But it’s easy to forget them, get confused, or be inconsistent with your colleagues.</p></li>
</ul>
<p>There is plenty of other configuration for Git, that can make it nicer.</p>
<section id="aliases">
<h3>Aliases<a class="headerlink" href="#aliases" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Aliases offer a way to improve the usability of Git: for
example <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">ci</span></code> instead of <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>.</p></li>
<li><p>Aliases are based on simple string replacement in the command.</p></li>
<li><p>Aliases can either be specific to a repository or global.</p>
<ul>
<li><p>Global aliases help you do the things you are used to across Git projects.</p></li>
<li><p>Per-project aliases can also be created.</p></li>
</ul>
</li>
<li><p>Global aliases are stored in <code class="docutils literal notranslate"><span class="pre">~/.gitconfig</span></code>.</p></li>
</ul>
</section>
<section id="example-alias-git-graph">
<h3>Example alias: git graph<a class="headerlink" href="#example-alias-git-graph" title="Link to this heading"></a></h3>
<p>A very useful shortcut which we use a lot in our workshops:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.graph<span class="w"> </span><span class="s2">&quot;log --all --graph --decorate --oneline&quot;</span>
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>your_git_repository
<span class="gp">$ </span>git<span class="w"> </span>graph
</pre></div>
</div>
</section>
<section id="using-external-commands">
<h3>Using external commands<a class="headerlink" href="#using-external-commands" title="Link to this heading"></a></h3>
<p>It is possible to call external commands using the exclamation mark character “!”.
In this example here we create a local alias which is
stored in <code class="docutils literal notranslate"><span class="pre">.git/config</span></code> and not synchronized with remotes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>your_git_repository
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>alias.hi<span class="w"> </span><span class="s1">&#39;!echo hello&#39;</span>
<span class="gp">$ </span>git<span class="w"> </span>hi
</pre></div>
</div>
<div class="admonition-food-for-thought-when-to-alias discussion important admonition" id="discussion-0">
<p class="admonition-title">Food for thought: When to alias?</p>
<ul class="simple">
<li><p>How many times should you wait before aliasing a command?</p></li>
<li><p>Do you believe a list of generic two-letter acronyms for common commands will
save your time?</p></li>
</ul>
</div>
</section>
<section id="list-of-aliases-the-instructors-use">
<h3>List of aliases the instructors use<a class="headerlink" href="#list-of-aliases-the-instructors-use" title="Link to this heading"></a></h3>
<p>You are welcome to reuse, suggest, improve.
You can see your current aliases in <code class="docutils literal notranslate"><span class="pre">~/.gitconfig</span></code>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.ap<span class="w"> </span><span class="s2">&quot;add --patch&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.br<span class="w"> </span>branch
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.ci<span class="w"> </span><span class="s2">&quot;commit -v&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.cip<span class="w"> </span><span class="s2">&quot;commit --patch -v&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.cl<span class="w"> </span><span class="s2">&quot;clone --recursive&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.di<span class="w"> </span>diff
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.dic<span class="w"> </span><span class="s2">&quot;diff --staged --color-words&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.diw<span class="w"> </span><span class="s2">&quot;diff --color-words&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.dis<span class="w"> </span><span class="s2">&quot;!git --no-pager diff --stat&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.fe<span class="w"> </span>fetch
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.graph<span class="w"> </span><span class="s2">&quot;log --all --graph --decorate --oneline&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rem<span class="w"> </span>remote
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.st<span class="w"> </span>status
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.su<span class="w"> </span><span class="s2">&quot;submodule update --init --recursive&quot;</span>
</pre></div>
</div>
<p>Here is what they do:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ap</span></code>: add, selecting parts individually, interactively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">br</span></code>: branch (obvious)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ci</span></code>: commit (check in), with <code class="docutils literal notranslate"><span class="pre">-v</span></code> option for clarity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cip</span></code>: commit, selecting parts individually, interactively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cl</span></code>: clone, init submodules (submodules are an advanced topic)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">di</span></code>: diff (obvious)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dic</span></code>: diff of staging area vs last commit (what is about to be committed)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diw</span></code>: a word diff, color.  Useful for small changes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dis</span></code>: a “diffstat”: what files are changed, not contents</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fe</span></code>: fetch (obvious)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">graph</span></code>: show whole git graph (so useful, some of us call it <code class="docutils literal notranslate"><span class="pre">l</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rem</span></code>: remote (obvious)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">st</span></code>: status (obvious)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">su</span></code>: submodule update (advanced)</p></li>
</ul>
<p>A useful setting for the <code class="docutils literal notranslate"><span class="pre">p</span></code> aliases:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>interactive.singlekey<span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
</section>
<section id="advanced-aliases">
<h3>Advanced aliases<a class="headerlink" href="#advanced-aliases" title="Link to this heading"></a></h3>
<p>These are advanced aliases and configuration options.  We won’t explain them,
but if you are bored, have some time, or want to go deeper, try to
figure out what they do.  You might want to check the Git manual
pages!</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.cif<span class="w"> </span><span class="s2">&quot;commit -v -p --fixup&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rb<span class="w"> </span><span class="s2">&quot;rebase --autosquash&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rbi<span class="w"> </span><span class="s2">&quot;rebase --interactive --autosquash&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rbis<span class="w"> </span><span class="s2">&quot;rebase --interactive --autosquash --autostash&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rbs<span class="w"> </span><span class="s2">&quot;rebase --autosquash --autostash&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rec<span class="w"> </span><span class="s2">&quot;!git --no-pager log --oneline --graph --decorate @{upstream}^^^..HEAD&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.ls-ignored<span class="w"> </span><span class="s2">&quot;ls-files -o -i --exclude-standard&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.new<span class="w"> </span><span class="s2">&quot;log HEAD..HEAD@{upstream}&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.news<span class="w"> </span><span class="s2">&quot;log --stat HEAD..HEAD@{upstream}&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.newd<span class="w"> </span><span class="s2">&quot;log --patch --color-words HEAD..HEAD@{upstream}&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.newdi<span class="w"> </span><span class="s2">&quot;diff --color-words HEAD...HEAD@{upstream}&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.rec<span class="w"> </span><span class="s2">&quot;!git --no-pager log --oneline --graph --decorate @{upstream}^^^..HEAD&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.reca<span class="w"> </span><span class="s2">&quot;!git --no-pager log --oneline --graph --decorate -n10 --all&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.recd<span class="w"> </span><span class="s2">&quot;log --decorate --patch @{upstream}^^^..HEAD&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>alias.recs<span class="w"> </span><span class="s2">&quot;!git --no-pager log --oneline --graph --decorate @{upstream}^^^..HEAD --stat&quot;</span>
</pre></div>
</div>
</section>
<section id="advanced-git-configuration">
<h3>Advanced Git configuration<a class="headerlink" href="#advanced-git-configuration" title="Link to this heading"></a></h3>
<p>Besides aliases, you can do plenty of other configuration of <code class="docutils literal notranslate"><span class="pre">git</span></code>.
Here are some of the most common ones:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>interactive.singlekey<span class="w"> </span><span class="nb">true</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>core.pager<span class="w"> </span><span class="s2">&quot;less -RS&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>core.excludesfile<span class="w"> </span>~/.gitignore
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>merge.conflictstyle<span class="w"> </span>diff3
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>diff.wordRegex<span class="w"> </span><span class="s2">&quot;[a-zA-Z0-9_]+|[^[:space:]]&quot;</span>
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>diff.mnemonicPrefix<span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
<p>Do you get tired of typing and copying and pasting your remote names
all the time, like <code class="docutils literal notranslate"><span class="pre">git&#64;github.com:myusername</span></code>?  You can create remote
aliases like this:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>url.git@github.com:.insteadOf<span class="w"> </span>gh:
<span class="gp">$ </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>url.git@github.com:/username/.insteadOf<span class="w"> </span>ghu:
</pre></div>
</div>
<p>Then, when you add a remote <code class="docutils literal notranslate"><span class="pre">ghu:recipe</span></code>, it will automatically be
translated to <code class="docutils literal notranslate"><span class="pre">git&#64;github.com:/username/recipe</span></code> using a simple prefix
matching.</p>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>If you are frustrated about remembering a command, you should create an alias.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-under-the-hood"></span><section id="git-under-the-hood">
<h2>Git under the hood<a class="headerlink" href="#git-under-the-hood" title="Link to this heading"></a></h2>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Verify that branches are pointers to commits and extremely lightweight.</p></li>
</ul>
</div>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<ul class="simple">
<li><p>10 min teaching/type-along</p></li>
<li><p>15 min exercise</p></li>
</ul>
</div>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/stranger.jpg"><img alt="Git under the hood" src="_images/stranger.jpg" style="width: 100%;" /></a>
</figure>
<section id="down-the-rabbit-hole">
<h3>Down the rabbit hole<a class="headerlink" href="#down-the-rabbit-hole" title="Link to this heading"></a></h3>
<p>When working with Git, <strong>you will never need to go inside .git</strong>, but in this
exercise we will, in order to learn about how branches are implemented in Git.</p>
<p>For this exercise create a new repository and commit a couple of changes.</p>
<p>Now that we’ve made a couple of commits let us look at what is happening under
the hood.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>.git
<span class="gp">$ </span>ls<span class="w"> </span>-l

<span class="go">drwxr-xr-x   - user 25 Aug 15:51 branches</span>
<span class="go">.rw-r--r-- 499 user 25 Aug 15:52 COMMIT_EDITMSG</span>
<span class="go">.rw-r--r--  92 user 25 Aug 15:51 config</span>
<span class="go">.rw-r--r--  73 user 25 Aug 15:51 description</span>
<span class="go">.rw-r--r--  21 user 25 Aug 15:51 HEAD</span>
<span class="go">drwxr-xr-x   - user 25 Aug 15:51 hooks</span>
<span class="go">.rw-r--r-- 137 user 25 Aug 15:52 index</span>
<span class="go">drwxr-xr-x   - user 25 Aug 15:51 info</span>
<span class="go">drwxr-xr-x   - user 25 Aug 15:52 logs</span>
<span class="go">drwxr-xr-x   - user 25 Aug 15:52 objects</span>
<span class="go">drwxr-xr-x   - user 25 Aug 15:51 refs</span>
</pre></div>
</div>
<p>Git stores everything under the .git folder in your repository. In fact, <strong>the
.git directory is the Git repository.</strong></p>
<p>Previously when you wrote the commit messages using your text editor, they
were in fact saved to <code class="docutils literal notranslate"><span class="pre">COMMIT_EDITMSG</span></code>.</p>
<p>Each commit in Git is stored as a “blob”. This blob contains information about
the author and the commit message. The blob references another blob that lists
the files present in the directory at the time and references blobs that record
the state of each file.</p>
<p>Commits are referenced by a SHA-1 hash (a 40-character hexadecimal string).</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/commit-and-tree.png"><img alt="A commit inside Git" src="_images/commit-and-tree.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">States of a Git file. Image from the <a class="reference external" href="https://git-scm.com/book/">Pro Git book</a>. License CC BY 3.0.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once you have several commits, each commit blob also links to the hash of the
previous commit. The commits form a <a class="reference external" href="http://eagain.net/articles/git-for-computer-scientists/">directed acyclic
graph</a> (do not worry
if the term is not familiar).</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/commits-and-parents.png"><img alt="A commit and its parents" src="_images/commits-and-parents.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">A commit and its parents. Image from the <a class="reference external" href="https://git-scm.com/book/">Pro Git book</a>. License CC BY 3.0.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>All branches and tags in Git are pointers to commits.</p>
</section>
<section id="git-is-basically-a-content-addressed-storage-system">
<h3>Git is basically a content-addressed storage system<a class="headerlink" href="#git-is-basically-a-content-addressed-storage-system" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>CAS: <a class="reference external" href="https://en.wikipedia.org/wiki/Content-addressable_storage">“mechanism for storing information that can be retrieved based on its content, not its storage location”</a></p></li>
<li><p>Content address is the content digest (SHA-1 checksum)</p></li>
<li><p>Stored data does not change - so when we modify commits, we always create new
commits.  Git doesn’t delete these right away, which is why it is <em>very hard
to lose data if you commit it once</em>.</p></li>
</ul>
<p>Let us poke a bit into raw objects! Start with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>HEAD
</pre></div>
</div>
<p>Then explore the <code class="docutils literal notranslate"><span class="pre">tree</span></code> object, then the <code class="docutils literal notranslate"><span class="pre">file</span></code> object, etc. recursively using the hashes you see.</p>
</section>
<section id="demonstration-experimenting-with-branches">
<h3>Demonstration: experimenting with branches<a class="headerlink" href="#demonstration-experimenting-with-branches" title="Link to this heading"></a></h3>
<p>Let us lift the hood and create few branches manually.  The
goal of this exercise is to hopefully create an “Aha!” moment and provide us a
good understanding of the underlying model.</p>
<p>We are starting from the <code class="docutils literal notranslate"><span class="pre">main</span></code> branch and create an <code class="docutils literal notranslate"><span class="pre">idea</span></code> branch:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>status

<span class="go">On branch main</span>
<span class="go">nothing to commit, working tree clean</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>switch<span class="w"> </span>--create<span class="w"> </span>idea

<span class="go">Switched to a new branch &#39;idea&#39;</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch

<span class="go">* idea</span>
<span class="go">  main</span>
</pre></div>
</div>
<p>Now let us go in:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>.git
<span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>refs/heads
<span class="gp">$ </span>ls<span class="w"> </span>-l

<span class="go">.rw-r--r-- 41 user 25 Aug 15:54 idea</span>
<span class="go">.rw-r--r-- 41 user 25 Aug 15:52 main</span>
</pre></div>
</div>
<p>Let us check what the <code class="docutils literal notranslate"><span class="pre">idea</span></code> file looks like
(do not worry if the hash is different):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cat<span class="w"> </span>idea

<span class="go">045e3db14740c60684d745e5fb891ae71e335611</span>
</pre></div>
</div>
<p>Now let us replicate this file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>cp<span class="w"> </span>idea<span class="w"> </span>idea-2
<span class="gp">$ </span>cp<span class="w"> </span>idea<span class="w"> </span>idea-3
<span class="gp">$ </span>cp<span class="w"> </span>idea<span class="w"> </span>idea-4
<span class="gp">$ </span>cp<span class="w"> </span>idea<span class="w"> </span>idea-5
</pre></div>
</div>
<p>Let us go up two levels and inspect the file <code class="docutils literal notranslate"><span class="pre">HEAD</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>../..
<span class="gp">$ </span>cat<span class="w"> </span>HEAD

<span class="go">ref: refs/heads/idea</span>
</pre></div>
</div>
<p>Let us open this file and change it to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="p">:</span> <span class="n">refs</span><span class="o">/</span><span class="n">heads</span><span class="o">/</span><span class="n">idea</span><span class="o">-</span><span class="mi">3</span>
</pre></div>
</div>
<p><strong>Now we are ready for the aha moment!</strong>
First let us go back to the working area:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>..
</pre></div>
</div>
<p>Now - on which branch are we?</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>git<span class="w"> </span>branch

<span class="go">  idea</span>
<span class="go">  idea-2</span>
<span class="go">* idea-3</span>
<span class="go">  idea-4</span>
<span class="go">  idea-5</span>
<span class="go">  main</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>Discuss the findings with other course participants.</p>
</div>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-reference"></span><section id="quick-reference">
<h2>Quick reference<a class="headerlink" href="#quick-reference" title="Link to this heading"></a></h2>
<section id="other-cheatsheets">
<h3>Other cheatsheets<a class="headerlink" href="#other-cheatsheets" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://aaltoscicomp.github.io/cheatsheets/git-the-way-you-need-it-cheatsheet.pdf">Detailed 2-page Git
cheatsheet</a></p></li>
<li><p><a class="reference external" href="http://www.ndpsoftware.com/git-cheatsheet.html">Interactive Git cheatsheet</a></p></li>
</ul>
</section>
<section id="glossary">
<h3>Glossary<a class="headerlink" href="#glossary" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>working directory/ workspace</strong>: the actual files you see and edit</p></li>
<li><p><strong>staging area</strong>: Place files go after <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> and before <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code></p></li>
<li><p><strong>hash</strong>: unique reference of any commit or state</p></li>
<li><p><strong>branch</strong>: One line of work.  Different branches can exist at the
same time and split/merge.</p></li>
<li><p><strong>HEAD</strong>: Pointer to the most recent commit on the current branch.</p></li>
<li><p><strong>remote</strong>: Roughly, another server that holds .git.</p></li>
<li><p><strong>origin</strong>: Default name for a remote repository.</p></li>
<li><p><strong>master</strong>: Default name for main branch on Git. Depending on the configuration and service,
the default branch is sometimes <strong>main</strong>.
In this lesson we configure Git so that the default branch is
called <strong>main</strong> to be more consistent with GitHub and GitLab.</p></li>
<li><p><strong>main</strong>: Default name for main branch on GitLab and GitHub.
In this lesson we configure Git so that the default branch is
called <strong>main</strong> to be more consistent with GitHub and GitLab.</p></li>
</ul>
</section>
<section id="commands-we-use">
<h3>Commands we use<a class="headerlink" href="#commands-we-use" title="Link to this heading"></a></h3>
<p>Setup:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span></code>: edit configuration options</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span> <span class="pre">-b</span> <span class="pre">main</span></code>: create new repository with <code class="docutils literal notranslate"><span class="pre">main</span></code> as the default branch</p></li>
</ul>
<p>See our status:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>: see status of files - use often!</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code>: see history of commits and their messages, newest first</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>: see a detailed graph of commits.  Create this command
with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--global</span> <span class="pre">alias.graph</span> <span class="pre">&quot;log</span> <span class="pre">--all</span> <span class="pre">--graph</span> <span class="pre">--decorate</span> <span class="pre">--oneline&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>: show difference between working directory and last commit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span> <span class="pre">--staged</span></code>: show difference between staging area and last commit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span> <span class="pre">COMMIT</span></code>: inspect individual commits</p></li>
</ul>
<p>General work:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">FILE</span></code>:</p>
<ul>
<li><p>Add a new file</p></li>
<li><p>Add a file to staging</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code>: record a version, add it to current branch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">--amend</span></code>: amend our last commit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span></code>: show which branch we’re on</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">NAME</span></code>: create a new branch called “name”</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span> <span class="pre">FILE</span></code>: restore last committed/staged version of FILE, losing unstaged changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">switch</span> <span class="pre">--create</span> <span class="pre">BRANCH-NAME</span></code>: create a new branch and switch to it</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">HASH</span></code>: create a new commit which reverts commit HASH</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--soft</span> <span class="pre">HASH</span></code>: remove all commits after HASH, but keep their modifications as staged changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HASH</span></code>: remove all commits after HASH, permanently throwing away their changes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">BRANCH-NAME</span></code>: merge branch BRANCH-NAME into current branch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">grep</span> <span class="pre">PATTERN</span></code>: search for patterns in tracked files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annotate</span> <span class="pre">FILE</span></code>: find out when a specific line got introduced and by whom</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code>: find a commit which broke some functionality</p></li>
</ul>
</section>
</section>
<span id="document-customizing"></span><section id="customizing-git">
<h2>Customizing Git<a class="headerlink" href="#customizing-git" title="Link to this heading"></a></h2>
<section id="shell-prompt">
<h3>Shell prompt<a class="headerlink" href="#shell-prompt" title="Link to this heading"></a></h3>
<div class="admonition-instructor-note instructor-note admonition" id="instructor-note-0">
<p class="admonition-title">Instructor note</p>
<p>Here the instructor can demonstrate how a context-aware and Git-aware shell
prompt can look like.</p>
</div>
<p>You can make your shell display contextual information about
your Git state even at all times.</p>
<p>Here are few example projects that make this possible and easy:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/jimeh/git-aware-prompt">https://github.com/jimeh/git-aware-prompt</a> (bash)</p></li>
<li><p><a class="reference external" href="https://ohmyz.sh/">https://ohmyz.sh/</a> (zsh)</p></li>
<li><p><a class="reference external" href="https://github.com/oh-my-fish/oh-my-fish">https://github.com/oh-my-fish/oh-my-fish</a> (fish)</p></li>
<li><p><a class="reference external" href="https://github.com/magicmonty/bash-git-prompt">https://github.com/magicmonty/bash-git-prompt</a> (bash and fish)</p></li>
</ul>
</section>
<section id="more-useful-diff-output">
<h3>More useful “diff” output<a class="headerlink" href="#more-useful-diff-output" title="Link to this heading"></a></h3>
<p><a class="reference external" href="https://github.com/dandavison/delta">Delta</a> is a syntax-highlighting pager for
git, diff, and grep output.  You can customize how you want to highlight the
“diff” output.  It allows side-by-side view, word-level diff highlighting,
improved merge conflict display, and much more.</p>
</section>
</section>
<span id="document-resources"></span><section id="other-resources">
<h2>Other resources<a class="headerlink" href="#other-resources" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://pcottle.github.io/learnGitBranching/">Learn Git branching</a></p></li>
<li><p><a class="reference external" href="http://git-scm.com/book">The entire Pro Git book, written by Scott Chacon and Ben Straub</a></p></li>
<li><p><a class="reference external" href="http://gitready.com">Learn git one commit at a time</a></p></li>
<li><p><a class="reference external" href="http://nvie.com/posts/a-successful-git-branching-model/">A successful Git branching model</a></p></li>
<li><p><a class="reference external" href="http://sethrobertson.github.io/GitBestPractices/">Commit Often, Perfect Later, Publish Once: Git Best Practices</a></p></li>
<li><p><a class="reference external" href="https://github.com/pluralsight/git-internals-pdf/releases">PeepCode Git Internals</a></p></li>
<li><p><a class="reference external" href="https://www.toptal.com/git/git-workflows-for-pros-a-good-git-guide">Git Workflows for Pros: A Good Git Guide</a></p></li>
<li><p><a class="reference external" href="http://dymitruk.com/blog/2012/02/05/branch-per-feature/">Branch-per-Feature</a></p></li>
<li><p><a class="reference external" href="http://xkcd.com/1597/">Git on XKCD</a></p></li>
<li><p><a class="reference external" href="http://fle.github.io/an-efficient-git-workflow-for-midlong-term-projects.html">An efficient GIT workflow for mid/long term projects</a></p></li>
</ul>
</section>
<span id="document-exercises"></span><section id="list-of-exercises">
<h2>List of exercises<a class="headerlink" href="#list-of-exercises" title="Link to this heading"></a></h2>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h3>
<p>Basics:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-record-changes"><span class="std std-ref">Exercise: Record changes</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-diff-and-rename"><span class="std std-ref">Optional exercises: Comparing changes</span></a></p></li>
</ul>
<p>Branching and merging:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-branches"><span class="std std-ref">Exercise: Create and commit to branches</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-branches-merging"><span class="std std-ref">Exercise: Merging branches</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-branches-optional"><span class="std std-ref">Optional exercises with branches</span></a></p></li>
</ul>
<p>Conflict resolution:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-conflicts"><span class="std std-ref">Exercise: Create and resolve a conflict</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-conflicts-optional"><span class="std std-ref">Optional exercises with conflict resolution</span></a></p></li>
</ul>
<p>Inspecting history:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-history"><span class="std std-ref">Exercise: Basic archaeology commands</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-bisect"><span class="std std-ref">Optional exercise: Git bisect</span></a></p></li>
</ul>
<p>Using the Git staging area:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-interactive-commits"><span class="std std-ref">Exercise: Interactive commits</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-staging-area"><span class="std std-ref">Exercise: Using the staging area</span></a></p></li>
</ul>
<p>Undoing and recovering:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-revert"><span class="std std-ref">Exercise: Revert a commit</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-amend"><span class="std std-ref">Exercise: Modify a previous commit</span></a></p></li>
<li><p><a class="reference internal" href="index.html#exercise-reset"><span class="std std-ref">Exercise: Git reset</span></a></p></li>
</ul>
<p>Interrupted work:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#exercise-stashing"><span class="std std-ref">Exercise: Stashing</span></a></p></li>
</ul>
</section>
<section id="full-list">
<h3>Full list<a class="headerlink" href="#full-list" title="Link to this heading"></a></h3>
<p>This is a list of all exercises and solutions in this lesson, mainly
as a reference for helpers and instructors.  This list is
automatically generated from all of the other pages in the lesson.
Any single teaching event will probably cover only a subset of these,
depending on their interests.</p>
</section>
</section>
<span id="document-guide"></span><section id="instructor-guide">
<h2>Instructor guide<a class="headerlink" href="#instructor-guide" title="Link to this heading"></a></h2>
<section id="schedule-day-1">
<h3>Schedule Day 1<a class="headerlink" href="#schedule-day-1" title="Link to this heading"></a></h3>
<p>Times here are in CE(S)T.</p>
<ul class="simple">
<li><p>08:50 - 09:00 (10 min) Soft start and icebreaker question</p></li>
<li><p>09:00 - 09:20 (20 min) Welcome and practical information</p></li>
<li><p>09:20 - 09:35 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/motivation/">Motivation</a></p></li>
<li><p>09:35 - 09:50 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/basics/">Basics - configuration and first commits</a></p></li>
<li><p>09:50 - 10:00 (10 min) Break</p></li>
<li><p><strong>10:00 - 10:20 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/basics/#exercise-record-changes">Exercise</a></strong></p>
<ul>
<li><p>Record changes</p></li>
<li><p>Optional exercises</p></li>
</ul>
</li>
<li><p>10:20 - 10:40 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/basics/#git-history-and-log">Basics - history, commit log, ignoring</a></p></li>
<li><p><strong>10:40 - 11:00 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/basics/#optional-exercises-comparing-changes">Exercise</a></strong></p>
<ul>
<li><p>One or all optional exercises</p></li>
</ul>
</li>
<li><p>11:00 - 12:00: Lunch break</p></li>
<li><p>12:00 - 12:15 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/branches/">Branching and merging</a></p></li>
<li><p><strong>12:15 - 12:35 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/branches/#exercise-create-and-commit-to-branches">Exercise</a></strong></p>
<ul>
<li><p>Branch-1</p></li>
<li><p>Branch-2</p></li>
</ul>
</li>
<li><p>12:35 - 12:50 (15 min) Summarize/discuss branching and merging</p></li>
<li><p>12:50 - 13:00 (10 min) Break</p></li>
<li><p>13:00 - 13:20 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/conflicts/">Conflict resolution</a></p></li>
<li><p>13:20 - 13:30 (10 min) Q&amp;A, feedback, and what will we be doing tomorrow?</p></li>
</ul>
</section>
<section id="schedule-day-2">
<h3>Schedule Day 2<a class="headerlink" href="#schedule-day-2" title="Link to this heading"></a></h3>
<p>Times here are in CE(S)T.</p>
<ul class="simple">
<li><p>08:50 - 09:00 (10 min) Soft start and icebreaker question</p></li>
<li><p>09:00 - 09:10 (10 min) Recap and Q&amp;A from day 1</p></li>
<li><p>09:10 - 09:25 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/remotes/">Sharing repositories online</a></p></li>
<li><p><strong>09:25 - 09:50 (25 min) Exercise</strong></p>
<ul>
<li><p>Set up SSH keys</p></li>
<li><p>Pushing our guacamole recipe repository to GitHub</p></li>
<li><p>Clone repository</p></li>
</ul>
</li>
<li><p>09:50 - 10:00 (10 min) Break</p></li>
<li><p>10:00 - 10:15 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/archaeology/">Inspecting history</a></p></li>
<li><p><strong>10:15 - 10:45 (30 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/archaeology/#exercise-basic-archaeology-commands">Exercise</a></strong></p>
<ul>
<li><p>History-1</p></li>
<li><p>History-2 is optional</p></li>
</ul>
</li>
<li><p>10:45 - 11:00 (15 min) Summarize/discuss inspecting history</p></li>
<li><p>11:00 - 12:00: Lunch break</p></li>
<li><p>12:00 - 12:15 (15 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/recovering/">Undoing and recovering</a></p></li>
<li><p><strong>12:15 - 12:40 (25 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/recovering/">Exercises</a></strong></p>
<ul>
<li><p>Undoing-1</p></li>
<li><p>Undoing-2</p></li>
<li><p>Undoing-3</p></li>
</ul>
</li>
<li><p>12:40 - 11:50 (10 min) Summarize undoing and recovering and discussion and mention that staging area exists</p></li>
<li><p>12:50 - 13:00 (10 min) Break</p></li>
<li><p>13:00 - 13:20 (20 min) <a class="reference external" href="https://coderefinery.github.io/git-intro/level/">How much Git is necessary?</a></p></li>
<li><p>13:20 - 13:30 (10 min) Q&amp;A, feedback, and what will we be doing tomorrow?</p></li>
</ul>
</section>
<section id="installation-reminders-for-each-day">
<h3>Installation reminders for each day<a class="headerlink" href="#installation-reminders-for-each-day" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Day 1: Git configuration</p></li>
<li><p>Day 2: SSH set up (if you don’t, sharing repositories online will be demo)</p></li>
</ul>
</section>
<section id="why-we-teach-this-lesson">
<h3>Why we teach this lesson<a class="headerlink" href="#why-we-teach-this-lesson" title="Link to this heading"></a></h3>
<p>Everyone should be using a version control system for their work, even if they’re working alone.
There are many version control systems out there, but Git is an industry standard and even if one uses another
system chances are high one still encounters Git repositories.</p>
<p>Specific motivations:</p>
<ul class="simple">
<li><p>Code easily becomes a disaster without version control</p></li>
<li><p>Mistakes happen - Git offers roll-back functionality and easy backup mechanism</p></li>
<li><p>One often needs to work on multiple things in parallel - branches solve that problem</p></li>
<li><p>Git enables people to collaborate on code or text without stepping on each other’s toes</p></li>
<li><p>Reproducibility: You can specify exact versions in publications enabling others to reproduce your work,
and if bugs are found one can find out exactly when it was introduced</p></li>
</ul>
<p>Many learners in a CodeRefinery workshop have developed code for a few years. A majority have
already encountered Git and have used it to some extent, but in most cases they do not yet feel
comfortable with it. They lack a good mental model of how Git operates and are afraid of making mistakes.
Other learners have never used Git before.
This lesson teaches how things are done in Git, which is useful for the newcomers,
but also how Git operates (e.g. what commits and branches really are) and what are some good
practices (e.g. how to use the staging area), which is useful for more experienced users.</p>
</section>
<section id="intended-learning-outcomes">
<h3>Intended learning outcomes<a class="headerlink" href="#intended-learning-outcomes" title="Link to this heading"></a></h3>
<p>By the end of this lesson, learners should:</p>
<ul class="simple">
<li><p>realize that version control is very important and Git is a valuable tool to learn and use</p></li>
<li><p>understand that Git is configurable and know how to set basic configurations</p></li>
<li><p>be able to set up Git repositories and make commits</p></li>
<li><p>understand that information on commits, branches etc. are stored under <code class="docutils literal notranslate"><span class="pre">.git/</span></code>, and have a
mental model of how that relates to the working directory</p></li>
<li><p>have a mental model of the different states a file can have in Git (untracked, modified, staged, unmodified)</p></li>
<li><p>know how to write good commit messages</p></li>
<li><p>have an idea of how the staging area can be used to craft good commits</p></li>
<li><p>know how to undo commits using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> and discard changes using <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span></code></p></li>
<li><p>understand that <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">restore</span></code> can be dangerous if changes have not been staged</p></li>
<li><p>know how to create branches and switch between branches</p></li>
<li><p>have a mental model of how branches work and get used to thinking of branches in a graphical (tree-structure) way</p></li>
<li><p>know how to merge branches and understand what that means in terms of combining different modifications</p></li>
<li><p>know how to resolve conflicts, or to abort conflicting merges</p></li>
<li><p>realize that conflicts are generally a good thing since they prevent incorrect merges</p></li>
<li><p>be able to set up a repository on GitHub and connect it with local repository</p></li>
<li><p>push changes to a remote repository</p></li>
<li><p>know a few ways to search through a repository and its history</p></li>
</ul>
</section>
<section id="how-to-teach-this-lesson">
<h3>How to teach this lesson<a class="headerlink" href="#how-to-teach-this-lesson" title="Link to this heading"></a></h3>
<section id="take-first-editor-steps-slowly">
<h4>Take first editor steps slowly<a class="headerlink" href="#take-first-editor-steps-slowly" title="Link to this heading"></a></h4>
<p>Some participants will be new to using a terminal text editor so please open,
edit, and close the editor (Nano) slowly in first type-along sessions and
exercises to avoid that participants will fall behind the instructor. At one
point a student did not follow the file edits of the instructor, and to correct
the mistake they had to do a manual merge, which they were not ready for.</p>
</section>
<section id="how-to-use-the-exercises">
<h4>How to use the exercises<a class="headerlink" href="#how-to-use-the-exercises" title="Link to this heading"></a></h4>
<p>Most episodes have standard exercises followed by optional (often more advanced) exercises
for more experienced learners so they don’t get bored waiting for the newcomers.
The instructor should briefly introduce the exercises and mention that after finishing the
standard exercise (and indicating that using the green sticky) the learners can move on to the
optional ones if they wish. When at least half of the learners have raised the green sticky
the instructor should go through the standard exercise to describe its most important take-home messages.
It’s also fine to briefly go though important points from the optional exercises, but don’t spend
too much time on it since everyone will not have attempted them.</p>
</section>
<section id="test-your-understanding-exercises">
<h4>“Test your understanding” exercises<a class="headerlink" href="#test-your-understanding-exercises" title="Link to this heading"></a></h4>
<p>Some episodes have a “test your understanding” exercise at the end which is intended as <em>formative assessment</em>,
i.e. an activity that provides feedback to instructors and learners on whether learning objectives are being met.
The instructor should end each episode by posing the “test your understanding” multiple-choice question,
giving learners a minute to think about it, and then asking for the right answer or asking learners to raise their
hands to signal which answer they think is correct.</p>
</section>
<section id="inspecting-history">
<h4>Inspecting history<a class="headerlink" href="#inspecting-history" title="Link to this heading"></a></h4>
<p>Key lesson is <em>how to find when something is broken or what commit has broken
the code</em>.</p>
<p>It can be useful to emphasize that it can be really valuable to be able to
search through the history of a project efficiently to find when bugs were
introduced or when something changed and why.  Also show that <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annotate</span></code>
and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> are available on GitHub and GitLab.</p>
<p>When discussing <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">annotate</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> the “when” is more important
than “who”. It is not to blame anybody but rather to find out whether published
results are affected.</p>
<p>Discuss how one would find out this information without version control.</p>
<p><strong>Questions to involve participants:</strong></p>
<ul class="simple">
<li><p>Have you ever found a bug in your code and wondered whether it has affected published results?</p></li>
<li><p>Have you ever wondered when, and by whom, a particular line of code was introduced?</p></li>
<li><p>Have you ever found out that a code behaves differently than it used to but you are not sure when
precisely this changed?</p></li>
</ul>
<p><strong>Confusion during <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> exercise:</strong></p>
<p>Learners may get stuck in the <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span></code> exercise if they incorrectly assign a commit
as <em>bad</em> or <em>good</em>.
To leave the bisect mode and return to the commit before <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">bisect</span> <span class="pre">start</span></code> was issued,
one can do</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>bisect<span class="w"> </span>reset
</pre></div>
</div>
<p>and start over if needed.</p>
</section>
<section id="live-better-than-reading-the-website-material">
<h4>Live better than reading the website material<a class="headerlink" href="#live-better-than-reading-the-website-material" title="Link to this heading"></a></h4>
<p>It is better to demonstrate the commands live and type-along. Ideally connecting
to examples discussed earlier.</p>
</section>
<section id="log-your-history-in-a-separate-window">
<h4>Log your history in a separate window<a class="headerlink" href="#log-your-history-in-a-separate-window" title="Link to this heading"></a></h4>
<p>The screencasting (shell window cheatsheet) hints have been moved to
the <a class="reference external" href="https://coderefinery.github.io/manuals/instructor-tech-setup/">presenting
manual</a>.</p>
</section>
<section id="create-a-cheatsheet-on-the-board">
<h4>Create a cheatsheet on the board<a class="headerlink" href="#create-a-cheatsheet-on-the-board" title="Link to this heading"></a></h4>
<p>For in-person workshops, create a “cheatsheet” on the board as you go. After
each command is introduced, write it on the board. After each module, make sure
you haven’t forgotten anything. Re-create and expand in future git lessons.
One strategy is:</p>
<ul class="simple">
<li><p>a common section for basic commands: <code class="docutils literal notranslate"><span class="pre">init</span></code>, <code class="docutils literal notranslate"><span class="pre">config</span></code>, <code class="docutils literal notranslate"><span class="pre">clone</span></code>, <code class="docutils literal notranslate"><span class="pre">help</span></code>, <code class="docutils literal notranslate"><span class="pre">stash</span></code></p></li>
<li><p>info commands, can be run anytime: <code class="docutils literal notranslate"><span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">log</span></code>, <code class="docutils literal notranslate"><span class="pre">diff</span></code>, <code class="docutils literal notranslate"><span class="pre">graph</span></code></p></li>
<li><p>A section for all the commands that move code from different states:
<code class="docutils literal notranslate"><span class="pre">add</span></code>, <code class="docutils literal notranslate"><span class="pre">commit</span></code>, etc.  See the visual cheat sheet below.</p></li>
</ul>
<p>You can get inspired by http://www.ndpsoftware.com/git-cheatsheet.html
to make your cheat sheet, but if you show this make it clear there are
far, far more commands on there than you need to know right now., and
it’s probably too confusing to use after this course.  But, the idea
of commands moving from the “working dir”, “staging area”, “commits”,
etc is good.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/cheat-sheet.jpg"><img alt="Example cheat sheet" src="_images/cheat-sheet.jpg" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-text">Example cheat sheet.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We also recommend to draw simple diagrams up on the board (e.g.: working
directory - staging area - repository with commands to move between) and keep
them there for students to refer to.</p>
</section>
<section id="draw-a-graph-on-the-board">
<h4>Draw a graph on the board<a class="headerlink" href="#draw-a-graph-on-the-board" title="Link to this heading"></a></h4>
<p>Draw the standard commit graphs on the board early on - you know, the
thing in all the diagrams.  Keep it updated all the time.  After the
first few samples, you can basically keep using the same graph the
whole lesson.  When you are introducing new commands, explain and
update the graph first, then run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code>, then do the command,
then look at <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> again.</p>
</section>
<section id="repeat-the-following-points">
<h4>Repeat the following points<a class="headerlink" href="#repeat-the-following-points" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Always check <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code>, and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> (our alias) before and
after every command until you get used to things. These give you a clear view
into what is going on, the key to knowing what you are doing.  Even
after you are used to things… anytime you do something you do
infrequently, it’s good to check.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">graph</span></code> is a direct representation of what we are drawing on the
board and should constantly be compared to it.</p></li>
<li><p>Once you <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> something, it’s almost impossible to lose it.
This is used all the time, for example once you commit or even add
it is hard to lose.  Commit before you merge or rebase. And so on.</p></li>
</ul>
</section>
<section id="start-from-identical-environment">
<h4>Start from identical environment<a class="headerlink" href="#start-from-identical-environment" title="Link to this heading"></a></h4>
<p>You probably have a highly optimized bash and git environment - one
that is different from students.  Move <code class="docutils literal notranslate"><span class="pre">.gitconfig</span></code> and <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> out
of the way before you start so that your environment is identical to
what students have.</p>
</section>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
</div>
<div class="admonition-why-github admonition">
<p class="admonition-title">Why GitHub?</p>
<p>In this introduction we will mention and use
<a class="reference external" href="https://github.com">GitHub</a> but also
<a class="reference external" href="https://gitlab.com">GitLab</a> and
<a class="reference external" href="https://bitbucket.org">Bitbucket</a> allow similar workflows and
basically everything that we will discuss is transferable. With this
material and these exercises we do not implicitly endorse the company
<a class="reference external" href="https://github.com">GitHub</a>. We have chosen to demonstrate a
number of concepts using examples with
<a class="reference external" href="https://github.com">GitHub</a> because it is currently the most
popular web platform for hosting Git repositories and the chance is
high that you will interact with
<a class="reference external" href="https://github.com">GitHub</a>-based repositories even if you choose
to host your Git repository on another platform.</p>
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>